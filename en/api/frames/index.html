
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Wandas ライブラリのドキュメント">
      
      
        <meta name="author" content="Wandas Team">
      
      
        <link rel="canonical" href="https://wandas.github.io/en/api/frames/">
      
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Frames Module - Wandas</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../assets/_markdown_exec_pyodide.css">
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-MEASUREMENT-ID"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-MEASUREMENT-ID",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-MEASUREMENT-ID",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#frames-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../" title="Wandas" class="md-header__button md-logo" aria-label="Wandas" data-md-component="logo">
      
  <img src="../../../assets/images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wandas
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Frames Module
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="ダークモードへ"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="ダークモードへ" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="ライトモードへ"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="ライトモードへ" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../api/frames/" hreflang="ja" class="md-select__link">
              日本語
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/kasahart/wandas" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    kasahart/wandas
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../tutorial/" class="md-tabs__link">
        
  
  
    
  
  Tutorials

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  API Reference

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../explanation/" class="md-tabs__link">
        
  
  
    
  
  Theory & Architecture

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing Guide

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../" title="Wandas" class="md-nav__button md-logo" aria-label="Wandas" data-md-component="logo">
      
  <img src="../../../assets/images/logo.png" alt="logo">

    </a>
    Wandas
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kasahart/wandas" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    kasahart/wandas
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorials
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../explanation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Theory & Architecture
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing Guide
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#channelframe" class="md-nav__link">
    <span class="md-ellipsis">
      ChannelFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChannelFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ChannelFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.time" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.n_samples" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.duration" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;duration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.add" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.rms_plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rms_plot
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.describe" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;describe
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.from_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.from_ndarray" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_ndarray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.from_file" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;from_file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.read_wav" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;read_wav
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.read_csv" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;read_csv
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.to_wav" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_wav
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.save" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.load" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.add_channel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;add_channel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.channel.ChannelFrame.remove_channel" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;remove_channel
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spectralframe" class="md-nav__link">
    <span class="md-ellipsis">
      SpectralFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SpectralFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SpectralFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.n_fft" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.window" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.magnitude" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;magnitude
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" magnitude">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.magnitude--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.phase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.phase--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.power" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;power
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.power--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.dB" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dB
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.dB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.dBA" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dBA
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dBA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.dBA--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.freqs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freqs
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" freqs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.freqs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.ifft" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;ifft
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ifft">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.ifft--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.noct_synthesis" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;noct_synthesis
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" noct_synthesis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot_matrix
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" plot_matrix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot_matrix--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectral.SpectralFrame.plot_matrix--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#spectrogramframe" class="md-nav__link">
    <span class="md-ellipsis">
      SpectrogramFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;SpectrogramFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" SpectrogramFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.n_fft" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.hop_length" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;hop_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.win_length" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;win_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.window" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;window
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.magnitude" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;magnitude
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" magnitude">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.magnitude--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.phase" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;phase
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" phase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.phase--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.power" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;power
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" power">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.power--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.dB" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dB
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.dB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.dBA" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dBA
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dBA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.dBA--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.n_frames" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_frames
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" n_frames">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.n_frames--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n_freq_bins
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" n_freq_bins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.freqs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freqs
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" freqs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.freqs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.times" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;times
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" times">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.times--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot_Aw
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" plot_Aw">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;get_frame_at
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" get_frame_at">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;to_channel_frame
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" to_channel_frame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#noctframe" class="md-nav__link">
    <span class="md-ellipsis">
      NOctFrame
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;NOctFrame
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" NOctFrame">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame--notes" class="md-nav__link">
    <span class="md-ellipsis">
      Notes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame-attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Attributes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.n" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.G" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;G
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.fr" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;fr
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.fmin" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;fmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.fmax" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;fmax
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.dB" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dB
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dB">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.dB--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.dBA" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;dBA
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" dBA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.dBA--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.freqs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-attribute"></code>&nbsp;freqs
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" freqs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.freqs--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.freqs--raises" class="md-nav__link">
    <span class="md-ellipsis">
      Raises
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.plot" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;plot
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" plot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.noct.NOctFrame.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mixins" class="md-nav__link">
    <span class="md-ellipsis">
      Mixins
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Mixins">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#channelprocessingmixin" class="md-nav__link">
    <span class="md-ellipsis">
      ChannelProcessingMixin
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChannelProcessingMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ChannelProcessingMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.high_pass_filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;high_pass_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.low_pass_filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;low_pass_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.band_pass_filter" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;band_pass_filter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.normalize" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;normalize
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.a_weighting" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;a_weighting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.abs" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.power" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;power
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.sum" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;sum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.mean" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;mean
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.trim" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;trim
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.fix_length" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fix_length
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.rms_trend" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;rms_trend
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.channel_difference" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;channel_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.resampling" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;resampling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_harmonic" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;hpss_harmonic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_percussive" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;hpss_percussive
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#channeltransformmixin" class="md-nav__link">
    <span class="md-ellipsis">
      ChannelTransformMixin
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;ChannelTransformMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" ChannelTransformMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.fft" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;fft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.welch" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;welch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.noct_spectrum" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;noct_spectrum
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.stft" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;stft
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.coherence" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;coherence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.csd" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;csd
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.transfer_function" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;transfer_function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="frames-module">Frames Module<a class="headerlink" href="#frames-module" title="Permanent link">&para;</a></h1>
<p>The <code>wandas.frames</code> module provides various data frame classes for manipulating and representing audio data.</p>
<h2 id="channelframe">ChannelFrame<a class="headerlink" href="#channelframe" title="Permanent link">&para;</a></h2>
<p>ChannelFrame is the basic frame for handling time-domain waveform data.</p>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.channel.ChannelFrame" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.channel.ChannelFrame</code>


<a href="#wandas.frames.channel.ChannelFrame" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            BaseFrame (wandas.core.base_frame.BaseFrame)" href="../../../api/#wandas.core.base_frame.BaseFrame">BaseFrame</a>[<a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a>]</code>, <code><a class="autorefs autorefs-internal" title="            ChannelProcessingMixin (wandas.frames.mixins.ChannelProcessingMixin)" href="../../../api/#wandas.frames.mixins.ChannelProcessingMixin">ChannelProcessingMixin</a></code>, <code><a class="autorefs autorefs-internal" title="            ChannelTransformMixin (wandas.frames.mixins.ChannelTransformMixin)" href="../../../api/#wandas.frames.mixins.ChannelTransformMixin">ChannelTransformMixin</a></code></p>


        <p>Channel-based data frame for handling audio signals and time series data.</p>
<p>This frame represents channel-based data such as audio signals and time series data,
with each channel containing data samples in the time domain.</p>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/channel.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChannelFrame</span><span class="p">(</span>
    <span class="n">BaseFrame</span><span class="p">[</span><span class="n">NDArrayReal</span><span class="p">],</span> <span class="n">ChannelProcessingMixin</span><span class="p">,</span> <span class="n">ChannelTransformMixin</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Channel-based data frame for handling audio signals and time series data.</span>

<span class="sd">    This frame represents channel-based data such as audio signals and time series data,</span>
<span class="sd">    with each channel containing data samples in the time domain.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">DaskArray</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a ChannelFrame.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: Dask array containing channel data.</span>
<span class="sd">            Shape should be (n_channels, n_samples).</span>
<span class="sd">            sampling_rate: The sampling rate of the data in Hz.</span>
<span class="sd">            label: A label for the frame.</span>
<span class="sd">            metadata: Optional metadata dictionary.</span>
<span class="sd">            operation_history: History of operations applied to the frame.</span>
<span class="sd">            channel_metadata: Metadata for each channel.</span>
<span class="sd">            previous: Reference to the previous frame in the processing chain.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If data has more than 2 dimensions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_n_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of channels.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get time array for the signal.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Array of time points in seconds.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the number of samples.&quot;&quot;&quot;</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">duration</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the duration in seconds.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_operation_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">operation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="c1"># Update metadata</span>
        <span class="n">operation_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">}</span>
        <span class="n">new_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation_metadata</span><span class="p">)</span>
        <span class="n">new_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">}</span>
        <span class="n">new_metadata</span><span class="p">[</span><span class="n">operation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new ChannelFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">operation_name</span> <span class="o">==</span> <span class="s2">&quot;resampling&quot;</span><span class="p">:</span>
            <span class="c1"># For resampling, update sampling rate</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_new_instance</span><span class="p">(</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;target_sr&quot;</span><span class="p">],</span>
                <span class="n">data</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">new_metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">new_history</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_new_instance</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">new_metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">new_history</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_binary_op</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ChannelFrame&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArrayReal</span><span class="p">,</span> <span class="s2">&quot;DaskArray&quot;</span><span class="p">],</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;DaskArray&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="s2">&quot;DaskArray&quot;</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Common implementation for binary operations</span>
<span class="sd">        - utilizing dask&#39;s lazy evaluation.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Right operand for the operation.</span>
<span class="sd">            op: Function to execute the operation (e.g., lambda a, b: a + b).</span>
<span class="sd">            symbol: Symbolic representation of the operation (e.g., &#39;+&#39;).</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new channel containing the operation result (lazy execution).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> operation (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Handle potentially None metadata and operation_history</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">operation_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">operation_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Check if other is a ChannelFrame - improved type checking</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ChannelFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sampling rates do not match. Cannot perform operation.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Perform operation directly on dask array (maintaining lazy execution)</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

            <span class="c1"># Merge channel metadata</span>
            <span class="n">merged_channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span><span class="p">,</span> <span class="n">other_ch</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_channel_metadata</span>
            <span class="p">):</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">merged_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">merged_channel_metadata</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Perform operation with scalar, NumPy array, or other types</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Apply operation directly on dask array (maintaining lazy execution)</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

            <span class="c1"># Operand display string</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ndarray</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">):</span>  <span class="c1"># Check for dask.array.Array</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dask.array</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

            <span class="c1"># Update channel metadata</span>
            <span class="n">updated_channel_metadata</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">updated_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other_str</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">updated_channel_metadata</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ChannelFrame&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArrayReal</span><span class="p">],</span>
        <span class="n">snr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add another signal or value to the current signal.</span>

<span class="sd">        If SNR is specified, performs addition with consideration for</span>
<span class="sd">        signal-to-noise ratio.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: Signal or value to add.</span>
<span class="sd">            snr: Signal-to-noise ratio (dB). If specified, adjusts the scale of the</span>
<span class="sd">                other signal based on this SNR.</span>
<span class="sd">                self is treated as the signal, and other as the noise.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new channel frame containing the addition result (lazy execution).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up add operation with SNR=</span><span class="si">{</span><span class="n">snr</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ChannelFrame</span><span class="p">):</span>
            <span class="c1"># Check if sampling rates match</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sampling rates do not match. Cannot perform operation.&quot;</span>
                <span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span>
                <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;array_data&quot;</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;Addition target with SNR must be a ChannelFrame or &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;NumPy array: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># If SNR is specified, adjust the length of the other signal</span>
        <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">duration</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fix_length</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">snr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;add_with_snr&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;waveform&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the frame data.</span>

<span class="sd">        Args:</span>
<span class="sd">            plot_type: Type of plot. Default is &quot;waveform&quot;.</span>
<span class="sd">            ax: Optional matplotlib axes for plotting.</span>
<span class="sd">            **kwargs: Additional arguments passed to the plot function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Single Axes object or iterator of Axes objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

        <span class="c1"># Get plot strategy</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">plot_strategy</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># Execute plot</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_ax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rms_plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">overlay</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">Aw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate an RMS plot.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax: Optional matplotlib axes for plotting.</span>
<span class="sd">            title: Title for the plot.</span>
<span class="sd">            overlay: Whether to overlay the plot on the existing axis.</span>
<span class="sd">            Aw: Apply A-weighting.</span>
<span class="sd">            **kwargs: Additional arguments passed to the plot function.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Single Axes object or iterator of Axes objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ylabel&quot;</span><span class="p">,</span> <span class="s2">&quot;RMS&quot;</span><span class="p">)</span>
        <span class="n">rms_ch</span><span class="p">:</span> <span class="n">ChannelFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rms_trend</span><span class="p">(</span><span class="n">Aw</span><span class="o">=</span><span class="n">Aw</span><span class="p">,</span> <span class="n">dB</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rms_ch</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">overlay</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">is_close</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Display visual and audio representation of the frame.</span>

<span class="sd">        Args:</span>
<span class="sd">            normalize: Whether to normalize the audio data for playback.</span>
<span class="sd">            is_close: Whether to close the figure after displaying.</span>
<span class="sd">            **kwargs: Additional parameters for visualization.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;axis_config is retained for backward compatibility but will be deprecated in the future.&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>
            <span class="n">axis_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;time_plot&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;time_plot&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;freq_plot&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;xlim&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">]:</span>
                    <span class="n">vlim</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">][</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="s2">&quot;ylim&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">]:</span>
                    <span class="n">ylim</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">][</span><span class="s2">&quot;ylim&quot;</span><span class="p">]</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ylim</span>

        <span class="k">if</span> <span class="s2">&quot;cbar_config&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="s2">&quot;cbar_config is retained for backward compatibility but will be deprecated in the future.&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>
            <span class="n">cbar_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cbar_config&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">cbar_config</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_config</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">cbar_config</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_config</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span>
            <span class="n">_ax</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;describe&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ch</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_ax</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">_ax</span><span class="p">))</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_ax</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
                <span class="n">ax</span> <span class="o">=</span> <span class="n">_ax</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Unexpected type for plot result: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">_ax</span><span class="p">)</span><span class="si">}</span><span class="s2">. Expected Axes or Iterator[Axes].&quot;</span>  <span class="c1"># noqa: E501</span>
                <span class="p">)</span>
            <span class="c1"># display関数とAudioクラスを使用</span>
            <span class="n">display</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_close</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
            <span class="n">display</span><span class="p">(</span><span class="n">Audio</span><span class="p">(</span><span class="n">ch</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">ch</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_numpy</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">NDArrayReal</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ch_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ch_units</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from a NumPy array.</span>

<span class="sd">        Args:</span>
<span class="sd">            data: NumPy array containing channel data.</span>
<span class="sd">            sampling_rate: The sampling rate in Hz.</span>
<span class="sd">            label: A label for the frame.</span>
<span class="sd">            metadata: Optional metadata dictionary.</span>
<span class="sd">            ch_labels: Labels for each channel.</span>
<span class="sd">            ch_units: Units for each channel.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the NumPy data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Convert NumPy array to dask array</span>
        <span class="n">dask_data</span> <span class="o">=</span> <span class="n">da_from_array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">dask_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span> <span class="ow">or</span> <span class="s2">&quot;numpy_data&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">cf</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
        <span class="k">if</span> <span class="n">ch_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of channel labels does not match the number of channels&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)):</span>
                <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">ch_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ch_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ch_units</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">ch_units</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch_units</span><span class="p">]</span> <span class="o">*</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_units</span><span class="p">)</span> <span class="o">!=</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of channel units does not match the number of channels&quot;</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_units</span><span class="p">)):</span>
                <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">ch_units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">cf</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_ndarray</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">array</span><span class="p">:</span> <span class="n">NDArrayReal</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">frame_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from a NumPy array.</span>

<span class="sd">        This method is deprecated. Use from_numpy instead.</span>

<span class="sd">        Args:</span>
<span class="sd">            array: Signal data. Each row corresponds to a channel.</span>
<span class="sd">            sampling_rate: Sampling rate (Hz).</span>
<span class="sd">            labels: Labels for each channel.</span>
<span class="sd">            unit: Unit of the signal.</span>
<span class="sd">            frame_label: Label for the frame.</span>
<span class="sd">            metadata: Optional metadata dictionary.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Redirect to from_numpy for compatibility</span>
        <span class="c1"># However, from_ndarray is deprecated</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;from_ndarray is deprecated. Use from_numpy instead.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">array</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">frame_label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">ch_units</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="n">channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">chunk_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ch_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from an audio file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to the audio file.</span>
<span class="sd">            channel: Channel(s) to load.</span>
<span class="sd">            start: Start time in seconds.</span>
<span class="sd">            end: End time in seconds.</span>
<span class="sd">            chunk_size: Chunk size for processing.</span>
<span class="sd">            Specifies the splitting size for lazy processing.</span>
<span class="sd">            ch_labels: Labels for each channel.</span>
<span class="sd">            **kwargs: Additional arguments passed to the file reader.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the loaded audio data.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If channel specification is invalid.</span>
<span class="sd">            TypeError: If channel parameter type is invalid.</span>
<span class="sd">            FileNotFoundError: If the file doesn&#39;t exist.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Get file reader</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">get_file_reader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="c1"># Get file info</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_file_info</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">sr</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;samplerate&quot;</span><span class="p">]</span>
        <span class="n">n_channels</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;channels&quot;</span><span class="p">]</span>
        <span class="n">n_frames</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;frames&quot;</span><span class="p">]</span>
        <span class="n">ch_labels</span> <span class="o">=</span> <span class="n">ch_labels</span> <span class="ow">or</span> <span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ch_labels&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File info: sr=</span><span class="si">{</span><span class="n">sr</span><span class="si">}</span><span class="s2">, channels=</span><span class="si">{</span><span class="n">n_channels</span><span class="si">}</span><span class="s2">, frames=</span><span class="si">{</span><span class="n">n_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Channel selection processing</span>
        <span class="n">all_channels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">channels_to_load</span> <span class="o">=</span> <span class="n">all_channels</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load all channels: </span><span class="si">{</span><span class="n">channels_to_load</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">&gt;=</span> <span class="n">n_channels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Channel specification is out of range: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2"> (valid range: 0-</span><span class="si">{</span><span class="n">n_channels</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: E501</span>
                <span class="p">)</span>
            <span class="n">channels_to_load</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel</span><span class="p">]</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load single channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ch</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ch</span> <span class="o">&gt;=</span> <span class="n">n_channels</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Channel specification is out of range: </span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2"> (valid range: 0-</span><span class="si">{</span><span class="n">n_channels</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: E501</span>
                    <span class="p">)</span>
            <span class="n">channels_to_load</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load specific channels: </span><span class="si">{</span><span class="n">channels_to_load</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;channel must be int, list, or None&quot;</span><span class="p">)</span>

        <span class="c1"># Index calculation</span>
        <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span> <span class="o">*</span> <span class="n">sr</span><span class="p">))</span>
        <span class="n">end_idx</span> <span class="o">=</span> <span class="n">n_frames</span> <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_frames</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span> <span class="o">*</span> <span class="n">sr</span><span class="p">))</span>
        <span class="n">frames_to_read</span> <span class="o">=</span> <span class="n">end_idx</span> <span class="o">-</span> <span class="n">start_idx</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Setting up lazy load from file=</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">, frames=</span><span class="si">{</span><span class="n">frames_to_read</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;start_idx=</span><span class="si">{</span><span class="n">start_idx</span><span class="si">}</span><span class="s2">, end_idx=</span><span class="si">{</span><span class="n">end_idx</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Settings for lazy loading</span>
        <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">channels_to_load</span><span class="p">),</span> <span class="n">frames_to_read</span><span class="p">)</span>

        <span class="c1"># Define the loading function using the file reader</span>
        <span class="k">def</span><span class="w"> </span><span class="nf">_load_audio</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; EXECUTING DELAYED LOAD &lt;&lt;&lt;&quot;</span><span class="p">)</span>
            <span class="c1"># Use the reader to get audio data with parameters</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">channels_to_load</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">frames_to_read</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected data type after reading file&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">out</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Creating delayed dask task with expected shape: </span><span class="si">{</span><span class="n">expected_shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Create delayed operation</span>
        <span class="n">delayed_data</span> <span class="o">=</span> <span class="n">dask_delayed</span><span class="p">(</span><span class="n">_load_audio</span><span class="p">)()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Wrapping delayed function in dask array&quot;</span><span class="p">)</span>

        <span class="c1"># Create dask array from delayed computation</span>
        <span class="n">dask_array</span> <span class="o">=</span> <span class="n">da_from_delayed</span><span class="p">(</span>
            <span class="n">delayed_data</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">expected_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">chunk_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">chunk_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Chunk size must be a positive integer&quot;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting chunk size: </span><span class="si">{</span><span class="n">chunk_size</span><span class="si">}</span><span class="s2"> for sample axis&quot;</span><span class="p">)</span>
            <span class="n">dask_array</span> <span class="o">=</span> <span class="n">dask_array</span><span class="o">.</span><span class="n">rechunk</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;ChannelFrame setup complete - actual file reading will occur on compute()&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>

        <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">dask_array</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
            <span class="p">},</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ch_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cf</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Number of channel labels does not match the number of specified channels&quot;</span>  <span class="c1"># noqa: E501</span>
                <span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)):</span>
                <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">ch_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">cf</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_wav</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utility method to read a WAV file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: Path to the WAV file.</span>
<span class="sd">            labels: Labels to set for each channel.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the data (lazy loading).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

        <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cf</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">time_column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Utility method to read a CSV file.</span>

<span class="sd">        Args:</span>
<span class="sd">            filename: Path to the CSV file.</span>
<span class="sd">            time_column: Index or name of the time column.</span>
<span class="sd">            labels: Labels to set for each channel.</span>
<span class="sd">            delimiter: Delimiter character.</span>
<span class="sd">            header: Row number to use as header.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the data (lazy loading).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

        <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
            <span class="n">filename</span><span class="p">,</span>
            <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">time_column</span><span class="o">=</span><span class="n">time_column</span><span class="p">,</span>
            <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
            <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cf</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the audio data to a WAV file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to save the file.</span>
<span class="sd">            format: File format. If None, determined from file extension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.io.wav_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_wav</span>

        <span class="n">write_wav</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">,</span>
        <span class="n">compress</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save the ChannelFrame to a WDF (Wandas Data File) format.</span>

<span class="sd">        This saves the complete frame including all channel data and metadata</span>
<span class="sd">        in a format that can be loaded back with full fidelity.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to save the file. &#39;.wdf&#39; extension will be added if not present.</span>
<span class="sd">            format: Format to use (currently only &#39;hdf5&#39; is supported)</span>
<span class="sd">            compress: Compression method (&#39;gzip&#39; by default, None for no compression)</span>
<span class="sd">            overwrite: Whether to overwrite existing file</span>
<span class="sd">            dtype: Optional data type conversion before saving (e.g. &#39;float32&#39;)</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileExistsError: If the file exists and overwrite=False.</span>
<span class="sd">            NotImplementedError: For unsupported formats.</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; cf = ChannelFrame.read_wav(&quot;audio.wav&quot;)</span>
<span class="sd">            &gt;&gt;&gt; cf.save(&quot;audio_analysis.wdf&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..io.wdf_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">save</span> <span class="k">as</span> <span class="n">wdf_save</span>

        <span class="n">wdf_save</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">path</span><span class="p">,</span>
            <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
            <span class="n">compress</span><span class="o">=</span><span class="n">compress</span><span class="p">,</span>
            <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a ChannelFrame from a WDF (Wandas Data File) file.</span>

<span class="sd">        This loads data saved with the save() method, preserving all channel data,</span>
<span class="sd">        metadata, labels, and units.</span>

<span class="sd">        Args:</span>
<span class="sd">            path: Path to the WDF file</span>
<span class="sd">            format: Format of the file (currently only &#39;hdf5&#39; is supported)</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame with all data and metadata loaded</span>

<span class="sd">        Raises:</span>
<span class="sd">            FileNotFoundError: If the file doesn&#39;t exist</span>
<span class="sd">            NotImplementedError: For unsupported formats</span>

<span class="sd">        Example:</span>
<span class="sd">            &gt;&gt;&gt; cf = ChannelFrame.load(&quot;audio_analysis.wdf&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..io.wdf_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">load</span> <span class="k">as</span> <span class="n">wdf_load</span>

        <span class="k">return</span> <span class="n">wdf_load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_additional_init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Provide additional initialization arguments required for ChannelFrame.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_channel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">DaskArray</span><span class="p">,</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">],</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;strict&quot;</span><span class="p">,</span>
        <span class="n">suffix_on_dup</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
        <span class="c1"># ndarray/dask/同型Frame対応</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ChannelFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sampling_rate不一致&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;pad&quot;</span><span class="p">:</span>
                    <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">n_samples</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span>
                    <span class="k">if</span> <span class="n">pad_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                            <span class="p">[</span>
                                <span class="n">arr</span><span class="p">,</span>
                                <span class="n">from_array</span><span class="p">(</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                                <span class="p">),</span>
                            <span class="p">],</span>
                            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;truncate&quot;</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
                        <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                            <span class="p">[</span>
                                <span class="n">arr</span><span class="p">,</span>
                                <span class="n">from_array</span><span class="p">(</span>
                                    <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                                <span class="p">),</span>
                            <span class="p">],</span>
                            <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                        <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;データ長不一致: align指定を確認&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
            <span class="n">new_labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">chmeta</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">new_label</span> <span class="o">=</span> <span class="n">chmeta</span><span class="o">.</span><span class="n">label</span>
                <span class="k">if</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">labels</span> <span class="ow">or</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">new_labels</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">suffix_on_dup</span><span class="p">:</span>
                        <span class="n">new_label</span> <span class="o">+=</span> <span class="n">suffix_on_dup</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;label重複: </span><span class="si">{</span><span class="n">new_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">new_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
            <span class="n">new_data</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="kn">from</span><span class="w"> </span><span class="nn">..core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>

            <span class="n">new_chmeta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">+</span> <span class="p">[</span>
                <span class="n">ChannelMetadata</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">new_labels</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
                <span class="k">return</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                    <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
                    <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                    <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                    <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                    <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
                    <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">from_array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DaskArray</span><span class="p">):</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">data</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_channel: ndarray/dask/同型Frameのみ対応&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;pad&quot;</span><span class="p">:</span>
                <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">pad_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">))],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;truncate&quot;</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
                    <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">))],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;データ長不一致: align指定を確認&quot;</span><span class="p">)</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
        <span class="n">new_label</span> <span class="o">=</span> <span class="n">label</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;ch</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">suffix_on_dup</span><span class="p">:</span>
                <span class="n">new_label</span> <span class="o">+=</span> <span class="n">suffix_on_dup</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;label重複&quot;</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>

        <span class="n">new_chmeta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">+</span> <span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">new_label</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">remove_channel</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> out of range&quot;</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">key</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;label </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">idx</span><span class="p">],</span> <span class="p">:]</span>
        <span class="n">new_chmeta</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">idx</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h3 id="wandas.frames.channel.ChannelFrame-attributes">Attributes<a href="#wandas.frames.channel.ChannelFrame-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.channel.ChannelFrame.time" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.time" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get time array for the signal.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Array of time points in seconds.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.channel.ChannelFrame.n_samples" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_samples</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.n_samples" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Returns the number of samples.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.channel.ChannelFrame.duration" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">duration</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.duration" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Returns the duration in seconds.</p>

    </div>

</div>

<h3 id="wandas.frames.channel.ChannelFrame-functions">Functions<a href="#wandas.frames.channel.ChannelFrame-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operation_history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channel_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a ChannelFrame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><span title="dask.array.core.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dask array containing channel data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_rate</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sampling rate of the data in Hz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A label for the frame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional metadata dictionary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>operation_history</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>History of operations applied to the frame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<a class="autorefs autorefs-internal" title="            ChannelMetadata (wandas.core.metadata.ChannelMetadata)" href="../../../api/#wandas.core.metadata.ChannelMetadata">ChannelMetadata</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Metadata for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>previous</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<a class="autorefs autorefs-internal" title="            BaseFrame (wandas.core.base_frame.BaseFrame)" href="../../../api/#wandas.core.base_frame.BaseFrame">BaseFrame</a>[<span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference to the previous frame in the processing chain.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If data has more than 2 dimensions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">DaskArray</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize a ChannelFrame.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: Dask array containing channel data.</span>
<span class="sd">        Shape should be (n_channels, n_samples).</span>
<span class="sd">        sampling_rate: The sampling rate of the data in Hz.</span>
<span class="sd">        label: A label for the frame.</span>
<span class="sd">        metadata: Optional metadata dictionary.</span>
<span class="sd">        operation_history: History of operations applied to the frame.</span>
<span class="sd">        channel_metadata: Metadata for each channel.</span>
<span class="sd">        previous: Reference to the previous frame in the processing chain.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If data has more than 2 dimensions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.add" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.add" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Add another signal or value to the current signal.</p>
<p>If SNR is specified, performs addition with consideration for
signal-to-noise ratio.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a>, <span title="int">int</span>, <span title="float">float</span>, <a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal or value to add.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>snr</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal-to-noise ratio (dB). If specified, adjusts the scale of the
other signal based on this SNR.
self is treated as the signal, and other as the noise.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new channel frame containing the addition result (lazy execution).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;ChannelFrame&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArrayReal</span><span class="p">],</span>
    <span class="n">snr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add another signal or value to the current signal.</span>

<span class="sd">    If SNR is specified, performs addition with consideration for</span>
<span class="sd">    signal-to-noise ratio.</span>

<span class="sd">    Args:</span>
<span class="sd">        other: Signal or value to add.</span>
<span class="sd">        snr: Signal-to-noise ratio (dB). If specified, adjusts the scale of the</span>
<span class="sd">            other signal based on this SNR.</span>
<span class="sd">            self is treated as the signal, and other as the noise.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new channel frame containing the addition result (lazy execution).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up add operation with SNR=</span><span class="si">{</span><span class="n">snr</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ChannelFrame</span><span class="p">):</span>
        <span class="c1"># Check if sampling rates match</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Sampling rates do not match. Cannot perform operation.&quot;</span>
            <span class="p">)</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span>
            <span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;array_data&quot;</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="s2">&quot;Addition target with SNR must be a ChannelFrame or &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;NumPy array: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># If SNR is specified, adjust the length of the other signal</span>
    <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">duration</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">fix_length</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">snr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;add_with_snr&quot;</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">snr</span><span class="o">=</span><span class="n">snr</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;waveform&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.plot" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the frame data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>plot_type</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type of plot. Default is "waveform".</p>
              </div>
            </td>
            <td>
                  <code>&#39;waveform&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="matplotlib.axes.Axes">Axes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional matplotlib axes for plotting.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to the plot function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="matplotlib.axes.Axes">Axes</span>, <span title="collections.abc.Iterator">Iterator</span>[<span title="matplotlib.axes.Axes">Axes</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single Axes object or iterator of Axes objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;waveform&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot the frame data.</span>

<span class="sd">    Args:</span>
<span class="sd">        plot_type: Type of plot. Default is &quot;waveform&quot;.</span>
<span class="sd">        ax: Optional matplotlib axes for plotting.</span>
<span class="sd">        **kwargs: Additional arguments passed to the plot function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Single Axes object or iterator of Axes objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

    <span class="c1"># Get plot strategy</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="n">plot_strategy</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># Execute plot</span>
    <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.rms_plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rms_plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">Aw</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.rms_plot" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Generate an RMS plot.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ax</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="matplotlib.axes.Axes">Axes</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional matplotlib axes for plotting.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>title</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Title for the plot.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overlay</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overlay the plot on the existing axis.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Aw</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Apply A-weighting.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to the plot function.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="matplotlib.axes.Axes">Axes</span>, <span title="collections.abc.Iterator">Iterator</span>[<span title="matplotlib.axes.Axes">Axes</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Single Axes object or iterator of Axes objects.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rms_plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">overlay</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">Aw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate an RMS plot.</span>

<span class="sd">    Args:</span>
<span class="sd">        ax: Optional matplotlib axes for plotting.</span>
<span class="sd">        title: Title for the plot.</span>
<span class="sd">        overlay: Whether to overlay the plot on the existing axis.</span>
<span class="sd">        Aw: Apply A-weighting.</span>
<span class="sd">        **kwargs: Additional arguments passed to the plot function.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Single Axes object or iterator of Axes objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kwargs</span> <span class="o">=</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;ylabel&quot;</span><span class="p">,</span> <span class="s2">&quot;RMS&quot;</span><span class="p">)</span>
    <span class="n">rms_ch</span><span class="p">:</span> <span class="n">ChannelFrame</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rms_trend</span><span class="p">(</span><span class="n">Aw</span><span class="o">=</span><span class="n">Aw</span><span class="p">,</span> <span class="n">dB</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rms_ch</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">overlay</span><span class="o">=</span><span class="n">overlay</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.describe" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">describe</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">is_close</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.describe" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Display visual and audio representation of the frame.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>normalize</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to normalize the audio data for playback.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_close</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to close the figure after displaying.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional parameters for visualization.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">describe</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">normalize</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">is_close</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Display visual and audio representation of the frame.</span>

<span class="sd">    Args:</span>
<span class="sd">        normalize: Whether to normalize the audio data for playback.</span>
<span class="sd">        is_close: Whether to close the figure after displaying.</span>
<span class="sd">        **kwargs: Additional parameters for visualization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;axis_config is retained for backward compatibility but will be deprecated in the future.&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>
        <span class="n">axis_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;time_plot&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;waveform&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;time_plot&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;freq_plot&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;xlim&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">]:</span>
                <span class="n">vlim</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">][</span><span class="s2">&quot;xlim&quot;</span><span class="p">]</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;ylim&quot;</span> <span class="ow">in</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">]:</span>
                <span class="n">ylim</span> <span class="o">=</span> <span class="n">axis_config</span><span class="p">[</span><span class="s2">&quot;freq_plot&quot;</span><span class="p">][</span><span class="s2">&quot;ylim&quot;</span><span class="p">]</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ylim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ylim</span>

    <span class="k">if</span> <span class="s2">&quot;cbar_config&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;cbar_config is retained for backward compatibility but will be deprecated in the future.&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>
        <span class="n">cbar_config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;cbar_config&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;vmin&quot;</span> <span class="ow">in</span> <span class="n">cbar_config</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_config</span><span class="p">[</span><span class="s2">&quot;vmin&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;vmax&quot;</span> <span class="ow">in</span> <span class="n">cbar_config</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cbar_config</span><span class="p">[</span><span class="s2">&quot;vmax&quot;</span><span class="p">]</span>

    <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Axes</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">ch</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s2">&quot;describe&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">ch</span><span class="o">.</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_ax</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">_ax</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_ax</span><span class="p">,</span> <span class="n">Axes</span><span class="p">):</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">_ax</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Unexpected type for plot result: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">_ax</span><span class="p">)</span><span class="si">}</span><span class="s2">. Expected Axes or Iterator[Axes].&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>
        <span class="c1"># display関数とAudioクラスを使用</span>
        <span class="n">display</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_close</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">Audio</span><span class="p">(</span><span class="n">ch</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">ch</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="n">normalize</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.from_numpy" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_numpy</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ch_units</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.from_numpy" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a ChannelFrame from a NumPy array.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NumPy array containing channel data.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_rate</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The sampling rate in Hz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A label for the frame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional metadata dictionary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ch_labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ch_units</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="list">list</span>[<span title="str">str</span>], <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Units for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the NumPy data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_numpy</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">NDArrayReal</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ch_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ch_units</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from a NumPy array.</span>

<span class="sd">    Args:</span>
<span class="sd">        data: NumPy array containing channel data.</span>
<span class="sd">        sampling_rate: The sampling rate in Hz.</span>
<span class="sd">        label: A label for the frame.</span>
<span class="sd">        metadata: Optional metadata dictionary.</span>
<span class="sd">        ch_labels: Labels for each channel.</span>
<span class="sd">        ch_units: Units for each channel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the NumPy data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Convert NumPy array to dask array</span>
    <span class="n">dask_data</span> <span class="o">=</span> <span class="n">da_from_array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">cf</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">dask_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span> <span class="ow">or</span> <span class="s2">&quot;numpy_data&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cf</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
    <span class="k">if</span> <span class="n">ch_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Number of channel labels does not match the number of channels&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)):</span>
            <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">ch_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ch_units</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ch_units</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ch_units</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch_units</span><span class="p">]</span> <span class="o">*</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_units</span><span class="p">)</span> <span class="o">!=</span> <span class="n">cf</span><span class="o">.</span><span class="n">n_channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Number of channel units does not match the number of channels&quot;</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_units</span><span class="p">)):</span>
            <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">ch_units</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">cf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.from_ndarray" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_ndarray</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">frame_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.from_ndarray" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a ChannelFrame from a NumPy array.</p>
<p>This method is deprecated. Use from_numpy instead.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal data. Each row corresponds to a channel.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampling_rate</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sampling rate (Hz).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>unit</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="list">list</span>[<span title="str">str</span>], <span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Unit of the signal.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>frame_label</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Label for the frame.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>metadata</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional metadata dictionary.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_ndarray</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">array</span><span class="p">:</span> <span class="n">NDArrayReal</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">unit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">frame_label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from a NumPy array.</span>

<span class="sd">    This method is deprecated. Use from_numpy instead.</span>

<span class="sd">    Args:</span>
<span class="sd">        array: Signal data. Each row corresponds to a channel.</span>
<span class="sd">        sampling_rate: Sampling rate (Hz).</span>
<span class="sd">        labels: Labels for each channel.</span>
<span class="sd">        unit: Unit of the signal.</span>
<span class="sd">        frame_label: Label for the frame.</span>
<span class="sd">        metadata: Optional metadata dictionary.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Redirect to from_numpy for compatibility</span>
    <span class="c1"># However, from_ndarray is deprecated</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;from_ndarray is deprecated. Use from_numpy instead.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">array</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">frame_label</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">ch_units</span><span class="o">=</span><span class="n">unit</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.from_file" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">from_file</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">chunk_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.from_file" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a ChannelFrame from an audio file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the audio file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="list">list</span>[<span title="int">int</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Channel(s) to load.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>start</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start time in seconds.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End time in seconds.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>chunk_size</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Chunk size for processing.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ch_labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional arguments passed to the file reader.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the loaded audio data.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If channel specification is invalid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="TypeError">TypeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If channel parameter type is invalid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file doesn't exist.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_file</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="n">channel</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">chunk_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ch_labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a ChannelFrame from an audio file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the audio file.</span>
<span class="sd">        channel: Channel(s) to load.</span>
<span class="sd">        start: Start time in seconds.</span>
<span class="sd">        end: End time in seconds.</span>
<span class="sd">        chunk_size: Chunk size for processing.</span>
<span class="sd">        Specifies the splitting size for lazy processing.</span>
<span class="sd">        ch_labels: Labels for each channel.</span>
<span class="sd">        **kwargs: Additional arguments passed to the file reader.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the loaded audio data.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If channel specification is invalid.</span>
<span class="sd">        TypeError: If channel parameter type is invalid.</span>
<span class="sd">        FileNotFoundError: If the file doesn&#39;t exist.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

    <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File not found: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Get file reader</span>
    <span class="n">reader</span> <span class="o">=</span> <span class="n">get_file_reader</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

    <span class="c1"># Get file info</span>
    <span class="n">info</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_file_info</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">sr</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;samplerate&quot;</span><span class="p">]</span>
    <span class="n">n_channels</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;channels&quot;</span><span class="p">]</span>
    <span class="n">n_frames</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;frames&quot;</span><span class="p">]</span>
    <span class="n">ch_labels</span> <span class="o">=</span> <span class="n">ch_labels</span> <span class="ow">or</span> <span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ch_labels&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;File info: sr=</span><span class="si">{</span><span class="n">sr</span><span class="si">}</span><span class="s2">, channels=</span><span class="si">{</span><span class="n">n_channels</span><span class="si">}</span><span class="s2">, frames=</span><span class="si">{</span><span class="n">n_frames</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Channel selection processing</span>
    <span class="n">all_channels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_channels</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">channel</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">channels_to_load</span> <span class="o">=</span> <span class="n">all_channels</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load all channels: </span><span class="si">{</span><span class="n">channels_to_load</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">channel</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">channel</span> <span class="o">&gt;=</span> <span class="n">n_channels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Channel specification is out of range: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2"> (valid range: 0-</span><span class="si">{</span><span class="n">n_channels</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>
        <span class="n">channels_to_load</span> <span class="o">=</span> <span class="p">[</span><span class="n">channel</span><span class="p">]</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load single channel: </span><span class="si">{</span><span class="n">channel</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">channel</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">channel</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ch</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ch</span> <span class="o">&gt;=</span> <span class="n">n_channels</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Channel specification is out of range: </span><span class="si">{</span><span class="n">ch</span><span class="si">}</span><span class="s2"> (valid range: 0-</span><span class="si">{</span><span class="n">n_channels</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span>  <span class="c1"># noqa: E501</span>
                <span class="p">)</span>
        <span class="n">channels_to_load</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">channel</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Will load specific channels: </span><span class="si">{</span><span class="n">channels_to_load</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;channel must be int, list, or None&quot;</span><span class="p">)</span>

    <span class="c1"># Index calculation</span>
    <span class="n">start_idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">start</span> <span class="o">*</span> <span class="n">sr</span><span class="p">))</span>
    <span class="n">end_idx</span> <span class="o">=</span> <span class="n">n_frames</span> <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">min</span><span class="p">(</span><span class="n">n_frames</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">end</span> <span class="o">*</span> <span class="n">sr</span><span class="p">))</span>
    <span class="n">frames_to_read</span> <span class="o">=</span> <span class="n">end_idx</span> <span class="o">-</span> <span class="n">start_idx</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Setting up lazy load from file=</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">, frames=</span><span class="si">{</span><span class="n">frames_to_read</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;start_idx=</span><span class="si">{</span><span class="n">start_idx</span><span class="si">}</span><span class="s2">, end_idx=</span><span class="si">{</span><span class="n">end_idx</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Settings for lazy loading</span>
    <span class="n">expected_shape</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">channels_to_load</span><span class="p">),</span> <span class="n">frames_to_read</span><span class="p">)</span>

    <span class="c1"># Define the loading function using the file reader</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_load_audio</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;&gt; EXECUTING DELAYED LOAD &lt;&lt;&lt;&quot;</span><span class="p">)</span>
        <span class="c1"># Use the reader to get audio data with parameters</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">channels_to_load</span><span class="p">,</span> <span class="n">start_idx</span><span class="p">,</span> <span class="n">frames_to_read</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unexpected data type after reading file&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Creating delayed dask task with expected shape: </span><span class="si">{</span><span class="n">expected_shape</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Create delayed operation</span>
    <span class="n">delayed_data</span> <span class="o">=</span> <span class="n">dask_delayed</span><span class="p">(</span><span class="n">_load_audio</span><span class="p">)()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Wrapping delayed function in dask array&quot;</span><span class="p">)</span>

    <span class="c1"># Create dask array from delayed computation</span>
    <span class="n">dask_array</span> <span class="o">=</span> <span class="n">da_from_delayed</span><span class="p">(</span>
        <span class="n">delayed_data</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">expected_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">chunk_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">chunk_size</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Chunk size must be a positive integer&quot;</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting chunk size: </span><span class="si">{</span><span class="n">chunk_size</span><span class="si">}</span><span class="s2"> for sample axis&quot;</span><span class="p">)</span>
        <span class="n">dask_array</span> <span class="o">=</span> <span class="n">dask_array</span><span class="o">.</span><span class="n">rechunk</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="n">chunk_size</span><span class="p">})</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">&quot;ChannelFrame setup complete - actual file reading will occur on compute()&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="p">)</span>

    <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">dask_array</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sr</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">path</span><span class="o">.</span><span class="n">stem</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span>
        <span class="p">},</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">ch_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cf</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Number of channel labels does not match the number of specified channels&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ch_labels</span><span class="p">)):</span>
            <span class="n">cf</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">ch_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.read_wav" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">read_wav</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.read_wav" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Utility method to read a WAV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the WAV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels to set for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the data (lazy loading).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_wav</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility method to read a WAV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: Path to the WAV file.</span>
<span class="sd">        labels: Labels to set for each channel.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the data (lazy loading).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

    <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.read_csv" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">read_csv</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">time_column</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.read_csv" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Utility method to read a CSV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>filename</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the CSV file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>time_column</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index or name of the time column.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="list">list</span>[<span title="str">str</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Labels to set for each channel.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>delimiter</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Delimiter character.</p>
              </div>
            </td>
            <td>
                  <code>&#39;,&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>header</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Row number to use as header.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the data (lazy loading).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">read_csv</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">time_column</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">delimiter</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span>
    <span class="n">header</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility method to read a CSV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        filename: Path to the CSV file.</span>
<span class="sd">        time_column: Index or name of the time column.</span>
<span class="sd">        labels: Labels to set for each channel.</span>
<span class="sd">        delimiter: Delimiter character.</span>
<span class="sd">        header: Row number to use as header.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the data (lazy loading).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

    <span class="n">cf</span> <span class="o">=</span> <span class="n">ChannelFrame</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span>
        <span class="n">filename</span><span class="p">,</span>
        <span class="n">ch_labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">time_column</span><span class="o">=</span><span class="n">time_column</span><span class="p">,</span>
        <span class="n">delimiter</span><span class="o">=</span><span class="n">delimiter</span><span class="p">,</span>
        <span class="n">header</span><span class="o">=</span><span class="n">header</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cf</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.to_wav" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_wav</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.to_wav" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Save the audio data to a WAV file.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>File format. If None, determined from file extension.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_wav</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="nb">format</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the audio data to a WAV file.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to save the file.</span>
<span class="sd">        format: File format. If None, determined from file extension.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.io.wav_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_wav</span>

    <span class="n">write_wav</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">),</span> <span class="bp">self</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.save" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;hdf5&#39;</span><span class="p">,</span> <span class="n">compress</span><span class="o">=</span><span class="s1">&#39;gzip&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.save" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Save the ChannelFrame to a WDF (Wandas Data File) format.</p>
<p>This saves the complete frame including all channel data and metadata
in a format that can be loaded back with full fidelity.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to save the file. '.wdf' extension will be added if not present.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Format to use (currently only 'hdf5' is supported)</p>
              </div>
            </td>
            <td>
                  <code>&#39;hdf5&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>compress</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Compression method ('gzip' by default, None for no compression)</p>
              </div>
            </td>
            <td>
                  <code>&#39;gzip&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>overwrite</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to overwrite existing file</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="numpy.dtype">dtype</span>[<span title="typing.Any">Any</span>]]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Optional data type conversion before saving (e.g. 'float32')</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileExistsError">FileExistsError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file exists and overwrite=False.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For unsupported formats.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>cf = ChannelFrame.read_wav("audio.wav")
cf.save("audio_analysis.wdf")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">,</span>
    <span class="n">compress</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;gzip&quot;</span><span class="p">,</span>
    <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">dtype</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Save the ChannelFrame to a WDF (Wandas Data File) format.</span>

<span class="sd">    This saves the complete frame including all channel data and metadata</span>
<span class="sd">    in a format that can be loaded back with full fidelity.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to save the file. &#39;.wdf&#39; extension will be added if not present.</span>
<span class="sd">        format: Format to use (currently only &#39;hdf5&#39; is supported)</span>
<span class="sd">        compress: Compression method (&#39;gzip&#39; by default, None for no compression)</span>
<span class="sd">        overwrite: Whether to overwrite existing file</span>
<span class="sd">        dtype: Optional data type conversion before saving (e.g. &#39;float32&#39;)</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileExistsError: If the file exists and overwrite=False.</span>
<span class="sd">        NotImplementedError: For unsupported formats.</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; cf = ChannelFrame.read_wav(&quot;audio.wav&quot;)</span>
<span class="sd">        &gt;&gt;&gt; cf.save(&quot;audio_analysis.wdf&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..io.wdf_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">save</span> <span class="k">as</span> <span class="n">wdf_save</span>

    <span class="n">wdf_save</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">path</span><span class="p">,</span>
        <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
        <span class="n">compress</span><span class="o">=</span><span class="n">compress</span><span class="p">,</span>
        <span class="n">overwrite</span><span class="o">=</span><span class="n">overwrite</span><span class="p">,</span>
        <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.load" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;hdf5&#39;</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#wandas.frames.channel.ChannelFrame.load" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Load a ChannelFrame from a WDF (Wandas Data File) file.</p>
<p>This loads data saved with the save() method, preserving all channel data,
metadata, labels, and units.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="str">str</span>, <span title="pathlib.Path">Path</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the WDF file</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>format</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Format of the file (currently only 'hdf5' is supported)</p>
              </div>
            </td>
            <td>
                  <code>&#39;hdf5&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            ChannelFrame (wandas.frames.channel.ChannelFrame)" href="../../../api/#wandas.frames.channel.ChannelFrame">ChannelFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame with all data and metadata loaded</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the file doesn't exist</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>For unsupported formats</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <blockquote>
<blockquote>
<blockquote>
<p>cf = ChannelFrame.load("audio_analysis.wdf")</p>
</blockquote>
</blockquote>
</blockquote>
</details>

            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Path</span><span class="p">],</span> <span class="o">*</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hdf5&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a ChannelFrame from a WDF (Wandas Data File) file.</span>

<span class="sd">    This loads data saved with the save() method, preserving all channel data,</span>
<span class="sd">    metadata, labels, and units.</span>

<span class="sd">    Args:</span>
<span class="sd">        path: Path to the WDF file</span>
<span class="sd">        format: Format of the file (currently only &#39;hdf5&#39; is supported)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame with all data and metadata loaded</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If the file doesn&#39;t exist</span>
<span class="sd">        NotImplementedError: For unsupported formats</span>

<span class="sd">    Example:</span>
<span class="sd">        &gt;&gt;&gt; cf = ChannelFrame.load(&quot;audio_analysis.wdf&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..io.wdf_io</span><span class="w"> </span><span class="kn">import</span> <span class="n">load</span> <span class="k">as</span> <span class="n">wdf_load</span>

    <span class="k">return</span> <span class="n">wdf_load</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.add_channel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">add_channel</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="n">suffix_on_dup</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.add_channel" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_channel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">DaskArray</span><span class="p">,</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">],</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">align</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;strict&quot;</span><span class="p">,</span>
    <span class="n">suffix_on_dup</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
    <span class="c1"># ndarray/dask/同型Frame対応</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ChannelFrame</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">data</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sampling_rate不一致&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;pad&quot;</span><span class="p">:</span>
                <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">n_samples</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span>
                <span class="k">if</span> <span class="n">pad_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">arr</span><span class="p">,</span>
                            <span class="n">from_array</span><span class="p">(</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;truncate&quot;</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
                    <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">arr</span><span class="p">,</span>
                            <span class="n">from_array</span><span class="p">(</span>
                                <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
                            <span class="p">),</span>
                        <span class="p">],</span>
                        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;データ長不一致: align指定を確認&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">_data</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
        <span class="n">new_labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">chmeta</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="n">new_label</span> <span class="o">=</span> <span class="n">chmeta</span><span class="o">.</span><span class="n">label</span>
            <span class="k">if</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">labels</span> <span class="ow">or</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">new_labels</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">suffix_on_dup</span><span class="p">:</span>
                    <span class="n">new_label</span> <span class="o">+=</span> <span class="n">suffix_on_dup</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;label重複: </span><span class="si">{</span><span class="n">new_label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">new_labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_label</span><span class="p">)</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>

        <span class="n">new_chmeta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">+</span> <span class="p">[</span>
            <span class="n">ChannelMetadata</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">lbl</span><span class="p">)</span> <span class="k">for</span> <span class="n">lbl</span> <span class="ow">in</span> <span class="n">new_labels</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">from_array</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">DaskArray</span><span class="p">):</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">data</span>
        <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;add_channel: ndarray/dask/同型Frameのみ対応&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;pad&quot;</span><span class="p">:</span>
            <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">pad_len</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">))],</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">align</span> <span class="o">==</span> <span class="s2">&quot;truncate&quot;</span><span class="p">:</span>
            <span class="n">arr</span> <span class="o">=</span> <span class="n">arr</span><span class="p">[:,</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span><span class="p">:</span>
                <span class="n">pad_len</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_samples</span> <span class="o">-</span> <span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">arr</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">arr</span><span class="p">,</span> <span class="n">from_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">pad_len</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">arr</span><span class="o">.</span><span class="n">dtype</span><span class="p">))],</span>
                    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;データ長不一致: align指定を確認&quot;</span><span class="p">)</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
    <span class="n">new_label</span> <span class="o">=</span> <span class="n">label</span> <span class="ow">or</span> <span class="sa">f</span><span class="s2">&quot;ch</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">new_label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">suffix_on_dup</span><span class="p">:</span>
            <span class="n">new_label</span> <span class="o">+=</span> <span class="n">suffix_on_dup</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;label重複&quot;</span><span class="p">)</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="n">concatenate</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">arr</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>

    <span class="n">new_chmeta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">+</span> <span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">new_label</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.channel.ChannelFrame.remove_channel" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">remove_channel</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#wandas.frames.channel.ChannelFrame.remove_channel" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>wandas/frames/channel.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_channel</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">key</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;index </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> out of range&quot;</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">key</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">label</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;label </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_channels</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">idx</span><span class="p">],</span> <span class="p">:]</span>
    <span class="n">new_chmeta</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="n">idx</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">new_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span> <span class="o">=</span> <span class="n">new_chmeta</span>
        <span class="k">return</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">new_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">new_chmeta</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="spectralframe">SpectralFrame<a class="headerlink" href="#spectralframe" title="Permanent link">&para;</a></h2>
<p>SpectralFrame is a frame for handling frequency-domain data.</p>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.spectral.SpectralFrame" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.spectral.SpectralFrame</code>


<a href="#wandas.frames.spectral.SpectralFrame" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            BaseFrame (wandas.core.base_frame.BaseFrame)" href="../../../api/#wandas.core.base_frame.BaseFrame">BaseFrame</a>[<a class="autorefs autorefs-internal" title="            NDArrayComplex = npt.NDArray[Complex]

  
      module-attribute
   (wandas.utils.types.NDArrayComplex)" href="../../../api/#wandas.utils.types.NDArrayComplex">NDArrayComplex</a>]</code></p>


        <p>Class for handling frequency-domain signal data.</p>
<p>This class represents spectral data, providing methods for spectral analysis,
manipulation, and visualization. It handles complex-valued frequency domain data
obtained through operations like FFT.</p>
<h4 id="wandas.frames.spectral.SpectralFrame--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame--parameters" title="Permanent link">&para;</a></h4>
<p>data : DaArray
    The spectral data. Must be a dask array with shape:
    - (channels, frequency_bins) for multi-channel data
    - (frequency_bins,) for single-channel data, which will be
      reshaped to (1, frequency_bins)
sampling_rate : float
    The sampling rate of the original time-domain signal in Hz.
n_fft : int
    The FFT size used to generate this spectral data.
window : str, default="hann"
    The window function used in the FFT.
label : str, optional
    A label for the frame.
metadata : dict, optional
    Additional metadata for the frame.
operation_history : list[dict], optional
    History of operations performed on this frame.
channel_metadata : list[ChannelMetadata], optional
    Metadata for each channel in the frame.
previous : BaseFrame, optional
    The frame that this frame was derived from.</p>
<h4 id="wandas.frames.spectral.SpectralFrame--attributes">Attributes<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame--attributes" title="Permanent link">&para;</a></h4>
<p>magnitude : NDArrayReal
    The magnitude spectrum of the data.
phase : NDArrayReal
    The phase spectrum in radians.
power : NDArrayReal
    The power spectrum (magnitude squared).
dB : NDArrayReal
    The spectrum in decibels relative to channel reference values.
dBA : NDArrayReal
    The A-weighted spectrum in decibels.
freqs : NDArrayReal
    The frequency axis values in Hz.</p>
<h4 id="wandas.frames.spectral.SpectralFrame--examples">Examples<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame--examples" title="Permanent link">&para;</a></h4>
<p>Create a SpectralFrame from FFT:</p>
<blockquote>
<blockquote>
<blockquote>
<p>signal = ChannelFrame.from_numpy(data, sampling_rate=44100)
spectrum = signal.fft(n_fft=2048)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Plot the magnitude spectrum:</p>
<blockquote>
<blockquote>
<blockquote>
<p>spectrum.plot()</p>
</blockquote>
</blockquote>
</blockquote>
<p>Perform binary operations:</p>
<blockquote>
<blockquote>
<blockquote>
<p>scaled = spectrum * 2.0
summed = spectrum1 + spectrum2  # Must have matching sampling rates</p>
</blockquote>
</blockquote>
</blockquote>
<p>Convert back to time domain:</p>
<blockquote>
<blockquote>
<blockquote>
<p>time_signal = spectrum.ifft()</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="wandas.frames.spectral.SpectralFrame--notes">Notes<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>All operations are performed lazily using dask arrays for efficient memory usage.</li>
<li>Binary operations (+, -, *, /) can be performed between SpectralFrames or with
  scalar values.</li>
<li>The class maintains the processing history and metadata through all operations.</li>
</ul>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SpectralFrame</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">NDArrayComplex</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for handling frequency-domain signal data.</span>

<span class="sd">    This class represents spectral data, providing methods for spectral analysis,</span>
<span class="sd">    manipulation, and visualization. It handles complex-valued frequency domain data</span>
<span class="sd">    obtained through operations like FFT.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : DaArray</span>
<span class="sd">        The spectral data. Must be a dask array with shape:</span>
<span class="sd">        - (channels, frequency_bins) for multi-channel data</span>
<span class="sd">        - (frequency_bins,) for single-channel data, which will be</span>
<span class="sd">          reshaped to (1, frequency_bins)</span>
<span class="sd">    sampling_rate : float</span>
<span class="sd">        The sampling rate of the original time-domain signal in Hz.</span>
<span class="sd">    n_fft : int</span>
<span class="sd">        The FFT size used to generate this spectral data.</span>
<span class="sd">    window : str, default=&quot;hann&quot;</span>
<span class="sd">        The window function used in the FFT.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        A label for the frame.</span>
<span class="sd">    metadata : dict, optional</span>
<span class="sd">        Additional metadata for the frame.</span>
<span class="sd">    operation_history : list[dict], optional</span>
<span class="sd">        History of operations performed on this frame.</span>
<span class="sd">    channel_metadata : list[ChannelMetadata], optional</span>
<span class="sd">        Metadata for each channel in the frame.</span>
<span class="sd">    previous : BaseFrame, optional</span>
<span class="sd">        The frame that this frame was derived from.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    magnitude : NDArrayReal</span>
<span class="sd">        The magnitude spectrum of the data.</span>
<span class="sd">    phase : NDArrayReal</span>
<span class="sd">        The phase spectrum in radians.</span>
<span class="sd">    power : NDArrayReal</span>
<span class="sd">        The power spectrum (magnitude squared).</span>
<span class="sd">    dB : NDArrayReal</span>
<span class="sd">        The spectrum in decibels relative to channel reference values.</span>
<span class="sd">    dBA : NDArrayReal</span>
<span class="sd">        The A-weighted spectrum in decibels.</span>
<span class="sd">    freqs : NDArrayReal</span>
<span class="sd">        The frequency axis values in Hz.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create a SpectralFrame from FFT:</span>
<span class="sd">    &gt;&gt;&gt; signal = ChannelFrame.from_numpy(data, sampling_rate=44100)</span>
<span class="sd">    &gt;&gt;&gt; spectrum = signal.fft(n_fft=2048)</span>

<span class="sd">    Plot the magnitude spectrum:</span>
<span class="sd">    &gt;&gt;&gt; spectrum.plot()</span>

<span class="sd">    Perform binary operations:</span>
<span class="sd">    &gt;&gt;&gt; scaled = spectrum * 2.0</span>
<span class="sd">    &gt;&gt;&gt; summed = spectrum1 + spectrum2  # Must have matching sampling rates</span>

<span class="sd">    Convert back to time domain:</span>
<span class="sd">    &gt;&gt;&gt; time_signal = spectrum.ifft()</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - All operations are performed lazily using dask arrays for efficient memory usage.</span>
<span class="sd">    - Binary operations (+, -, *, /) can be performed between SpectralFrames or with</span>
<span class="sd">      scalar values.</span>
<span class="sd">    - The class maintains the processing history and metadata through all operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the magnitude spectrum.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The absolute values of the complex spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">phase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the phase spectrum.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The phase angles of the complex spectrum in radians.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the power spectrum.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The squared magnitude spectrum.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dB</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the spectrum in decibels.</span>

<span class="sd">        The reference values are taken from channel metadata. If no reference</span>
<span class="sd">        is specified, uses 1.0.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The spectrum in dB relative to channel references.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mag</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span>
        <span class="n">ref_values</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ch</span><span class="o">.</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">])</span>
        <span class="n">level</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">mag</span> <span class="o">/</span> <span class="n">ref_values</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">level</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dBA</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the A-weighted spectrum in decibels.</span>

<span class="sd">        Applies A-weighting filter to the spectrum for better correlation with</span>
<span class="sd">        perceived loudness.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The A-weighted spectrum in dB.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weighted</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">A_weighting</span><span class="p">(</span><span class="n">frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="n">min_db</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dB</span> <span class="o">+</span> <span class="n">weighted</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_n_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of channels in the data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">freqs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the frequency axis values in Hz.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            Array of frequency values corresponding to each frequency bin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_operation_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">operation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implementation of operation application for spectral data.</span>

<span class="sd">        This internal method handles the application of various operations to</span>
<span class="sd">        spectral data, maintaining lazy evaluation through dask.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        operation_name : str</span>
<span class="sd">            Name of the operation to apply.</span>
<span class="sd">        **params : Any</span>
<span class="sd">            Parameters for the operation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        S</span>
<span class="sd">            A new instance with the operation applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="c1"># Update metadata</span>
        <span class="n">operation_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">}</span>
        <span class="n">new_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation_metadata</span><span class="p">)</span>
        <span class="n">new_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">}</span>
        <span class="n">new_metadata</span><span class="p">[</span><span class="n">operation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new ChannelFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_new_instance</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">new_metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">new_history</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_binary_op</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">,</span> <span class="n">NDArrayComplex</span><span class="p">,</span> <span class="n">NDArrayReal</span><span class="p">,</span> <span class="s2">&quot;DaArray&quot;</span>
        <span class="p">],</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;DaArray&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="s2">&quot;DaArray&quot;</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Common implementation for binary operations.</span>

<span class="sd">        This method handles binary operations between SpectralFrames and various types</span>
<span class="sd">        of operands, maintaining lazy evaluation through dask arrays.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Union[SpectralFrame, int, float, complex,</span>
<span class="sd">                        NDArrayComplex, NDArrayReal, DaArray]</span>
<span class="sd">            The right operand of the operation.</span>
<span class="sd">        op : callable</span>
<span class="sd">            Function to execute the operation (e.g., lambda a, b: a + b)</span>
<span class="sd">        symbol : str</span>
<span class="sd">            String representation of the operation (e.g., &#39;+&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SpectralFrame</span>
<span class="sd">            A new SpectralFrame containing the result of the operation.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If attempting to operate with a SpectralFrame</span>
<span class="sd">            with a different sampling rate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> operation (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Handle potentially None metadata and operation_history</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">operation_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">operation_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1"># Check if other is a ChannelFrame - improved type checking</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SpectralFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Sampling rates do not match. Cannot perform operation.&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Directly operate on dask arrays (maintaining lazy execution)</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

            <span class="c1"># Combine channel metadata</span>
            <span class="n">merged_channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span><span class="p">,</span> <span class="n">other_ch</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_channel_metadata</span>
            <span class="p">):</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">merged_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">merged_channel_metadata</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Operation with scalar, NumPy array, or other types</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Apply operation directly to dask array (maintaining lazy execution)</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

            <span class="c1"># String representation of operand for display</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;complex(</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">real</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">imag</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ndarray</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">):</span>  <span class="c1"># Check for dask.array.Array</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dask.array</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

            <span class="c1"># Update channel metadata</span>
            <span class="n">updated_channel_metadata</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">updated_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other_str</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">updated_channel_metadata</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;frequency&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the spectral data using various visualization strategies.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str, default=&quot;frequency&quot;</span>
<span class="sd">            Type of plot to create. Options include:</span>
<span class="sd">            - &quot;frequency&quot;: Standard frequency plot</span>
<span class="sd">            - &quot;matrix&quot;: Matrix plot for comparing channels</span>
<span class="sd">            - Other types as defined by available plot strategies</span>
<span class="sd">        ax : matplotlib.axes.Axes, optional</span>
<span class="sd">            Axes to plot on. If None, creates new axes.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">            Common options include:</span>
<span class="sd">            - title: Plot title</span>
<span class="sd">            - xlabel, ylabel: Axis labels</span>
<span class="sd">            - vmin, vmax: Value limits for plots</span>
<span class="sd">            - cmap: Colormap name</span>
<span class="sd">            - dB: Whether to plot in decibels</span>
<span class="sd">            - Aw: Whether to apply A-weighting</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Axes, Iterator[Axes]]</span>
<span class="sd">            The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">            for multi-plot outputs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

        <span class="c1"># Get plot strategy</span>
        <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectralFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># Execute plot</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_ax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ifft</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compute the Inverse Fast Fourier Transform (IFFT) to return to time domain.</span>

<span class="sd">        This method transforms the frequency-domain data back to the time domain using</span>
<span class="sd">        the inverse FFT operation. The window function used in the forward FFT is</span>
<span class="sd">        taken into account to ensure proper reconstruction.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChannelFrame</span>
<span class="sd">            A new ChannelFrame containing the time-domain signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">IFFT</span><span class="p">,</span> <span class="n">create_operation</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;ifft&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;IFFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># Apply processing to data</span>
        <span class="n">time_series</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Create new instance</span>
        <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">time_series</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ifft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_additional_init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Provide additional initialization arguments required for SpectralFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict[str, Any]</span>
<span class="sd">            Additional initialization arguments for SpectralFrame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">noct_synthesis</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NOctFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Synthesize N-octave band spectrum.</span>

<span class="sd">        This method combines frequency components into N-octave bands according to</span>
<span class="sd">        standard acoustical band definitions. This is commonly used in noise and</span>
<span class="sd">        vibration analysis.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fmin : float</span>
<span class="sd">            Lower frequency bound in Hz.</span>
<span class="sd">        fmax : float</span>
<span class="sd">            Upper frequency bound in Hz.</span>
<span class="sd">        n : int, default=3</span>
<span class="sd">            Number of bands per octave (e.g., 3 for third-octave bands).</span>
<span class="sd">        G : int, default=10</span>
<span class="sd">            Reference band number.</span>
<span class="sd">        fr : int, default=1000</span>
<span class="sd">            Reference frequency in Hz.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NOctFrame</span>
<span class="sd">            A new NOctFrame containing the N-octave band spectrum.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the sampling rate is not 48000 Hz, which is required for this operation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="mi">48000</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;noct_synthesis can only be used with a sampling rate of 48000 Hz.&quot;</span>
            <span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctSynthesis</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">.noct</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctFrame</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fmin&quot;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s2">&quot;fmax&quot;</span><span class="p">:</span> <span class="n">fmax</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span> <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="n">fr</span><span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;noct_synthesis&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;NOctSynthesis&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># Apply processing to data</span>
        <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">NOctFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span>
            <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">G</span><span class="o">=</span><span class="n">G</span><span class="p">,</span>
            <span class="n">fr</span><span class="o">=</span><span class="n">fr</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">Oct of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;noct_synthesis&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_matrix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;matrix&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot channel relationships in matrix format.</span>

<span class="sd">        This method creates a matrix plot showing relationships between channels,</span>
<span class="sd">        such as coherence, transfer functions, or cross-spectral density.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str, default=&quot;matrix&quot;</span>
<span class="sd">            Type of matrix plot to create.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional plot parameters:</span>
<span class="sd">            - vmin, vmax: Color scale limits</span>
<span class="sd">            - cmap: Colormap name</span>
<span class="sd">            - title: Plot title</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Axes, Iterator[Axes]]</span>
<span class="sd">            The matplotlib axes containing the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

        <span class="c1"># Get plot strategy</span>
        <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectralFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># Execute plot</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h3 id="wandas.frames.spectral.SpectralFrame-attributes">Attributes<a href="#wandas.frames.spectral.SpectralFrame-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.n_fft" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.n_fft" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.window" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">window</span> <span class="o">=</span> <span class="n">window</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.window" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.magnitude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">magnitude</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.magnitude" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the magnitude spectrum.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.magnitude--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.magnitude--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The absolute values of the complex spectrum.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.phase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">phase</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.phase" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the phase spectrum.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.phase--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.phase--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The phase angles of the complex spectrum in radians.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.power" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">power</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.power" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the power spectrum.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.power--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.power--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The squared magnitude spectrum.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.dB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dB</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.dB" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the spectrum in decibels.</p>
<p>The reference values are taken from channel metadata. If no reference
is specified, uses 1.0.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.dB--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.dB--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The spectrum in dB relative to channel references.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.dBA" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dBA</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.dBA" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the A-weighted spectrum in decibels.</p>
<p>Applies A-weighting filter to the spectrum for better correlation with
perceived loudness.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.dBA--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.dBA--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The A-weighted spectrum in dB.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectral.SpectralFrame.freqs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">freqs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectral.SpectralFrame.freqs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the frequency axis values in Hz.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.freqs--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.freqs--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    Array of frequency values corresponding to each frequency bin.</p>

    </div>

</div>

<h3 id="wandas.frames.spectral.SpectralFrame-functions">Functions<a href="#wandas.frames.spectral.SpectralFrame-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectral.SpectralFrame.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operation_history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channel_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.spectral.SpectralFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Data must be 1-dimensional or 2-dimensional. Shape: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectral.SpectralFrame.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;frequency&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.spectral.SpectralFrame.plot" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the spectral data using various visualization strategies.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.plot--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.plot--parameters" title="Permanent link">&para;</a></h6>
<p>plot_type : str, default="frequency"
    Type of plot to create. Options include:
    - "frequency": Standard frequency plot
    - "matrix": Matrix plot for comparing channels
    - Other types as defined by available plot strategies
ax : matplotlib.axes.Axes, optional
    Axes to plot on. If None, creates new axes.
**kwargs : dict
    Additional keyword arguments passed to the plot strategy.
    Common options include:
    - title: Plot title
    - xlabel, ylabel: Axis labels
    - vmin, vmax: Value limits for plots
    - cmap: Colormap name
    - dB: Whether to plot in decibels
    - Aw: Whether to apply A-weighting</p>
<h6 id="wandas.frames.spectral.SpectralFrame.plot--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.plot--returns" title="Permanent link">&para;</a></h6>
<p>Union[Axes, Iterator[Axes]]
    The matplotlib axes containing the plot, or an iterator of axes
    for multi-plot outputs.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;frequency&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the spectral data using various visualization strategies.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str, default=&quot;frequency&quot;</span>
<span class="sd">        Type of plot to create. Options include:</span>
<span class="sd">        - &quot;frequency&quot;: Standard frequency plot</span>
<span class="sd">        - &quot;matrix&quot;: Matrix plot for comparing channels</span>
<span class="sd">        - Other types as defined by available plot strategies</span>
<span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<span class="sd">        Axes to plot on. If None, creates new axes.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">        Common options include:</span>
<span class="sd">        - title: Plot title</span>
<span class="sd">        - xlabel, ylabel: Axis labels</span>
<span class="sd">        - vmin, vmax: Value limits for plots</span>
<span class="sd">        - cmap: Colormap name</span>
<span class="sd">        - dB: Whether to plot in decibels</span>
<span class="sd">        - Aw: Whether to apply A-weighting</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Axes, Iterator[Axes]]</span>
<span class="sd">        The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">        for multi-plot outputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

    <span class="c1"># Get plot strategy</span>
    <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectralFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># Execute plot</span>
    <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectral.SpectralFrame.ifft" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">ifft</span><span class="p">()</span></code>

<a href="#wandas.frames.spectral.SpectralFrame.ifft" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the Inverse Fast Fourier Transform (IFFT) to return to time domain.</p>
<p>This method transforms the frequency-domain data back to the time domain using
the inverse FFT operation. The window function used in the forward FFT is
taken into account to ensure proper reconstruction.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.ifft--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.ifft--returns" title="Permanent link">&para;</a></h6>
<p>ChannelFrame
    A new ChannelFrame containing the time-domain signal.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ifft</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Inverse Fast Fourier Transform (IFFT) to return to time domain.</span>

<span class="sd">    This method transforms the frequency-domain data back to the time domain using</span>
<span class="sd">    the inverse FFT operation. The window function used in the forward FFT is</span>
<span class="sd">    taken into account to ensure proper reconstruction.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ChannelFrame</span>
<span class="sd">        A new ChannelFrame containing the time-domain signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">IFFT</span><span class="p">,</span> <span class="n">create_operation</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;ifft&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;IFFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># Apply processing to data</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Create new instance</span>
    <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">time_series</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;ifft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectral.SpectralFrame.noct_synthesis" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">noct_synthesis</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fr</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

<a href="#wandas.frames.spectral.SpectralFrame.noct_synthesis" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Synthesize N-octave band spectrum.</p>
<p>This method combines frequency components into N-octave bands according to
standard acoustical band definitions. This is commonly used in noise and
vibration analysis.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.noct_synthesis--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--parameters" title="Permanent link">&para;</a></h6>
<p>fmin : float
    Lower frequency bound in Hz.
fmax : float
    Upper frequency bound in Hz.
n : int, default=3
    Number of bands per octave (e.g., 3 for third-octave bands).
G : int, default=10
    Reference band number.
fr : int, default=1000
    Reference frequency in Hz.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.noct_synthesis--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--returns" title="Permanent link">&para;</a></h6>
<p>NOctFrame
    A new NOctFrame containing the N-octave band spectrum.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.noct_synthesis--raises">Raises<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.noct_synthesis--raises" title="Permanent link">&para;</a></h6>
<p>ValueError
    If the sampling rate is not 48000 Hz, which is required for this operation.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">noct_synthesis</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NOctFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Synthesize N-octave band spectrum.</span>

<span class="sd">    This method combines frequency components into N-octave bands according to</span>
<span class="sd">    standard acoustical band definitions. This is commonly used in noise and</span>
<span class="sd">    vibration analysis.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    fmin : float</span>
<span class="sd">        Lower frequency bound in Hz.</span>
<span class="sd">    fmax : float</span>
<span class="sd">        Upper frequency bound in Hz.</span>
<span class="sd">    n : int, default=3</span>
<span class="sd">        Number of bands per octave (e.g., 3 for third-octave bands).</span>
<span class="sd">    G : int, default=10</span>
<span class="sd">        Reference band number.</span>
<span class="sd">    fr : int, default=1000</span>
<span class="sd">        Reference frequency in Hz.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    NOctFrame</span>
<span class="sd">        A new NOctFrame containing the N-octave band spectrum.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    ValueError</span>
<span class="sd">        If the sampling rate is not 48000 Hz, which is required for this operation.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="mi">48000</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;noct_synthesis can only be used with a sampling rate of 48000 Hz.&quot;</span>
        <span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctSynthesis</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.noct</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctFrame</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fmin&quot;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s2">&quot;fmax&quot;</span><span class="p">:</span> <span class="n">fmax</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span> <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="n">fr</span><span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;noct_synthesis&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">..processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;NOctSynthesis&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># Apply processing to data</span>
    <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">NOctFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span>
        <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="n">G</span><span class="p">,</span>
        <span class="n">fr</span><span class="o">=</span><span class="n">fr</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">Oct of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;noct_synthesis&quot;</span><span class="p">,</span>
                <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectral.SpectralFrame.plot_matrix" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot_matrix</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;matrix&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.spectral.SpectralFrame.plot_matrix" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot channel relationships in matrix format.</p>
<p>This method creates a matrix plot showing relationships between channels,
such as coherence, transfer functions, or cross-spectral density.</p>
<h6 id="wandas.frames.spectral.SpectralFrame.plot_matrix--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.plot_matrix--parameters" title="Permanent link">&para;</a></h6>
<p>plot_type : str, default="matrix"
    Type of matrix plot to create.
**kwargs : dict
    Additional plot parameters:
    - vmin, vmax: Color scale limits
    - cmap: Colormap name
    - title: Plot title</p>
<h6 id="wandas.frames.spectral.SpectralFrame.plot_matrix--returns">Returns<a class="headerlink" href="#wandas.frames.spectral.SpectralFrame.plot_matrix--returns" title="Permanent link">&para;</a></h6>
<p>Union[Axes, Iterator[Axes]]
    The matplotlib axes containing the plot.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectral.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_matrix</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;matrix&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot channel relationships in matrix format.</span>

<span class="sd">    This method creates a matrix plot showing relationships between channels,</span>
<span class="sd">    such as coherence, transfer functions, or cross-spectral density.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str, default=&quot;matrix&quot;</span>
<span class="sd">        Type of matrix plot to create.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional plot parameters:</span>
<span class="sd">        - vmin, vmax: Color scale limits</span>
<span class="sd">        - cmap: Colormap name</span>
<span class="sd">        - title: Plot title</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Axes, Iterator[Axes]]</span>
<span class="sd">        The matplotlib axes containing the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

    <span class="c1"># Get plot strategy</span>
    <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectralFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># Execute plot</span>
    <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="spectrogramframe">SpectrogramFrame<a class="headerlink" href="#spectrogramframe" title="Permanent link">&para;</a></h2>
<p>SpectrogramFrame is a frame for handling time-frequency domain (spectrogram) data.</p>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.spectrogram.SpectrogramFrame" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.spectrogram.SpectrogramFrame</code>


<a href="#wandas.frames.spectrogram.SpectrogramFrame" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            BaseFrame (wandas.core.base_frame.BaseFrame)" href="../../../api/#wandas.core.base_frame.BaseFrame">BaseFrame</a>[<a class="autorefs autorefs-internal" title="            NDArrayComplex = npt.NDArray[Complex]

  
      module-attribute
   (wandas.utils.types.NDArrayComplex)" href="../../../api/#wandas.utils.types.NDArrayComplex">NDArrayComplex</a>]</code></p>


        <p>Class for handling time-frequency domain data (spectrograms).</p>
<p>This class represents spectrogram data obtained through
Short-Time Fourier Transform (STFT)
or similar time-frequency analysis methods. It provides methods for visualization,
manipulation, and conversion back to time domain.</p>
<h4 id="wandas.frames.spectrogram.SpectrogramFrame--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame--parameters" title="Permanent link">&para;</a></h4>
<p>data : DaArray
    The spectrogram data. Must be a dask array with shape:
    - (channels, frequency_bins, time_frames) for multi-channel data
    - (frequency_bins, time_frames) for single-channel data, which will be
      reshaped to (1, frequency_bins, time_frames)
sampling_rate : float
    The sampling rate of the original time-domain signal in Hz.
n_fft : int
    The FFT size used to generate this spectrogram.
hop_length : int
    Number of samples between successive frames.
win_length : int, optional
    The window length in samples. If None, defaults to n_fft.
window : str, default="hann"
    The window function to use (e.g., "hann", "hamming", "blackman").
label : str, optional
    A label for the frame.
metadata : dict, optional
    Additional metadata for the frame.
operation_history : list[dict], optional
    History of operations performed on this frame.
channel_metadata : list[ChannelMetadata], optional
    Metadata for each channel in the frame.
previous : BaseFrame, optional
    The frame that this frame was derived from.</p>
<h4 id="wandas.frames.spectrogram.SpectrogramFrame--attributes">Attributes<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame--attributes" title="Permanent link">&para;</a></h4>
<p>magnitude : NDArrayReal
    The magnitude spectrogram.
phase : NDArrayReal
    The phase spectrogram in radians.
power : NDArrayReal
    The power spectrogram.
dB : NDArrayReal
    The spectrogram in decibels relative to channel reference values.
dBA : NDArrayReal
    The A-weighted spectrogram in decibels.
n_frames : int
    Number of time frames.
n_freq_bins : int
    Number of frequency bins.
freqs : NDArrayReal
    The frequency axis values in Hz.
times : NDArrayReal
    The time axis values in seconds.</p>
<h4 id="wandas.frames.spectrogram.SpectrogramFrame--examples">Examples<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame--examples" title="Permanent link">&para;</a></h4>
<p>Create a spectrogram from a time-domain signal:</p>
<blockquote>
<blockquote>
<blockquote>
<p>signal = ChannelFrame.from_wav("audio.wav")
spectrogram = signal.stft(n_fft=2048, hop_length=512)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Extract a specific time frame:</p>
<blockquote>
<blockquote>
<blockquote>
<p>frame_at_1s = spectrogram.get_frame_at(int(1.0 * sampling_rate / hop_length))</p>
</blockquote>
</blockquote>
</blockquote>
<p>Convert back to time domain:</p>
<blockquote>
<blockquote>
<blockquote>
<p>reconstructed = spectrogram.to_channel_frame()</p>
</blockquote>
</blockquote>
</blockquote>
<p>Plot the spectrogram:</p>
<blockquote>
<blockquote>
<blockquote>
<p>spectrogram.plot()</p>
</blockquote>
</blockquote>
</blockquote>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SpectrogramFrame</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">NDArrayComplex</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for handling time-frequency domain data (spectrograms).</span>

<span class="sd">    This class represents spectrogram data obtained through</span>
<span class="sd">    Short-Time Fourier Transform (STFT)</span>
<span class="sd">    or similar time-frequency analysis methods. It provides methods for visualization,</span>
<span class="sd">    manipulation, and conversion back to time domain.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : DaArray</span>
<span class="sd">        The spectrogram data. Must be a dask array with shape:</span>
<span class="sd">        - (channels, frequency_bins, time_frames) for multi-channel data</span>
<span class="sd">        - (frequency_bins, time_frames) for single-channel data, which will be</span>
<span class="sd">          reshaped to (1, frequency_bins, time_frames)</span>
<span class="sd">    sampling_rate : float</span>
<span class="sd">        The sampling rate of the original time-domain signal in Hz.</span>
<span class="sd">    n_fft : int</span>
<span class="sd">        The FFT size used to generate this spectrogram.</span>
<span class="sd">    hop_length : int</span>
<span class="sd">        Number of samples between successive frames.</span>
<span class="sd">    win_length : int, optional</span>
<span class="sd">        The window length in samples. If None, defaults to n_fft.</span>
<span class="sd">    window : str, default=&quot;hann&quot;</span>
<span class="sd">        The window function to use (e.g., &quot;hann&quot;, &quot;hamming&quot;, &quot;blackman&quot;).</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        A label for the frame.</span>
<span class="sd">    metadata : dict, optional</span>
<span class="sd">        Additional metadata for the frame.</span>
<span class="sd">    operation_history : list[dict], optional</span>
<span class="sd">        History of operations performed on this frame.</span>
<span class="sd">    channel_metadata : list[ChannelMetadata], optional</span>
<span class="sd">        Metadata for each channel in the frame.</span>
<span class="sd">    previous : BaseFrame, optional</span>
<span class="sd">        The frame that this frame was derived from.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    magnitude : NDArrayReal</span>
<span class="sd">        The magnitude spectrogram.</span>
<span class="sd">    phase : NDArrayReal</span>
<span class="sd">        The phase spectrogram in radians.</span>
<span class="sd">    power : NDArrayReal</span>
<span class="sd">        The power spectrogram.</span>
<span class="sd">    dB : NDArrayReal</span>
<span class="sd">        The spectrogram in decibels relative to channel reference values.</span>
<span class="sd">    dBA : NDArrayReal</span>
<span class="sd">        The A-weighted spectrogram in decibels.</span>
<span class="sd">    n_frames : int</span>
<span class="sd">        Number of time frames.</span>
<span class="sd">    n_freq_bins : int</span>
<span class="sd">        Number of frequency bins.</span>
<span class="sd">    freqs : NDArrayReal</span>
<span class="sd">        The frequency axis values in Hz.</span>
<span class="sd">    times : NDArrayReal</span>
<span class="sd">        The time axis values in seconds.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create a spectrogram from a time-domain signal:</span>
<span class="sd">    &gt;&gt;&gt; signal = ChannelFrame.from_wav(&quot;audio.wav&quot;)</span>
<span class="sd">    &gt;&gt;&gt; spectrogram = signal.stft(n_fft=2048, hop_length=512)</span>

<span class="sd">    Extract a specific time frame:</span>
<span class="sd">    &gt;&gt;&gt; frame_at_1s = spectrogram.get_frame_at(int(1.0 * sampling_rate / hop_length))</span>

<span class="sd">    Convert back to time domain:</span>
<span class="sd">    &gt;&gt;&gt; reconstructed = spectrogram.to_channel_frame()</span>

<span class="sd">    Plot the spectrogram:</span>
<span class="sd">    &gt;&gt;&gt; spectrogram.plot()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># type: ignore [unused-ignore]</span>
        <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;データは2次元または3次元である必要があります。形状: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_fft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;データの形状が無効です。周波数ビン数は </span><span class="si">{</span><span class="n">n_fft</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> である必要があります。&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span> <span class="o">=</span> <span class="n">hop_length</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">win_length</span> <span class="o">=</span> <span class="n">win_length</span> <span class="k">if</span> <span class="n">win_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">magnitude</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the magnitude spectrogram.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The absolute values of the complex spectrogram.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">phase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the phase spectrogram.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The phase angles of the complex spectrogram in radians.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the power spectrogram.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The squared magnitude of the complex spectrogram.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dB</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the spectrogram in decibels relative to each channel&#39;s reference value.</span>

<span class="sd">        The reference value for each channel is specified in its metadata.</span>
<span class="sd">        A minimum value of -120 dB is enforced to avoid numerical issues.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The spectrogram in decibels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># dB規定値を_channel_metadataから収集</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ch</span><span class="o">.</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">])</span>
        <span class="c1"># dB変換</span>
        <span class="c1"># 0除算を避けるために、最大値と1e-12のいずれかを使用</span>
        <span class="n">level</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">magnitude</span> <span class="o">/</span> <span class="n">ref</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">level</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dBA</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the A-weighted spectrogram in decibels.</span>

<span class="sd">        A-weighting applies a frequency-dependent weighting filter that approximates</span>
<span class="sd">        the human ear&#39;s response. This is particularly useful for analyzing noise</span>
<span class="sd">        and acoustic measurements.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The A-weighted spectrogram in decibels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weighted</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">A_weighting</span><span class="p">(</span><span class="n">frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="n">min_db</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dB</span> <span class="o">+</span> <span class="n">weighted</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>  <span class="c1"># 周波数軸に沿ってブロードキャスト</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_n_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of channels in the data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of channels.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_frames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of time frames.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of time frames in the spectrogram.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">n_freq_bins</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of frequency bins.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of frequency bins (n_fft // 2 + 1).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">freqs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the frequency axis values in Hz.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            Array of frequency values corresponding to each frequency bin.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfftfreq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">times</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the time axis values in seconds.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            Array of time values corresponding to each time frame.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_operation_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">operation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implementation of operation application for spectrogram data.</span>

<span class="sd">        This internal method handles the application of various operations to</span>
<span class="sd">        spectrogram data, maintaining lazy evaluation through dask.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        operation_name : str</span>
<span class="sd">            Name of the operation to apply.</span>
<span class="sd">        **params : Any</span>
<span class="sd">            Parameters for the operation.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        S</span>
<span class="sd">            A new instance with the operation applied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">processed_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">operation_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">}</span>
        <span class="n">new_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operation_metadata</span><span class="p">)</span>
        <span class="n">new_metadata</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">}</span>
        <span class="n">new_metadata</span><span class="p">[</span><span class="n">operation_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectrogramFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_new_instance</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">processed_data</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">new_metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">new_history</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_binary_op</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;SpectrogramFrame&quot;</span><span class="p">,</span>
            <span class="nb">int</span><span class="p">,</span>
            <span class="nb">float</span><span class="p">,</span>
            <span class="nb">complex</span><span class="p">,</span>
            <span class="n">NDArrayComplex</span><span class="p">,</span>
            <span class="n">NDArrayReal</span><span class="p">,</span>
            <span class="s2">&quot;DaArray&quot;</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="s2">&quot;DaArray&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="s2">&quot;DaArray&quot;</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectrogramFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Common implementation for binary operations.</span>

<span class="sd">        This method handles binary operations between</span>
<span class="sd">        SpectrogramFrames and various types</span>
<span class="sd">        of operands, maintaining lazy evaluation through dask arrays.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Union[SpectrogramFrame, int, float, complex,</span>
<span class="sd">            NDArrayComplex, NDArrayReal, DaArray]</span>
<span class="sd">            The right operand of the operation.</span>
<span class="sd">        op : callable</span>
<span class="sd">            Function to execute the operation (e.g., lambda a, b: a + b)</span>
<span class="sd">        symbol : str</span>
<span class="sd">            String representation of the operation (e.g., &#39;+&#39;)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SpectrogramFrame</span>
<span class="sd">            A new SpectrogramFrame containing the result of the operation.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If attempting to operate with a SpectrogramFrame</span>
<span class="sd">            with a different sampling rate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Setting up </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> operation (lazy)&quot;</span><span class="p">)</span>

        <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">metadata</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">operation_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">operation_history</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SpectrogramFrame</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">other</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;サンプリングレートが一致していません。演算できません。&quot;</span>
                <span class="p">)</span>

            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

            <span class="n">merged_channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span><span class="p">,</span> <span class="n">other_ch</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_channel_metadata</span>
            <span class="p">):</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_ch</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">merged_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">SpectrogramFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
                <span class="n">hop_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span><span class="p">,</span>
                <span class="n">win_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">win_length</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">merged_channel_metadata</span><span class="p">,</span>
                <span class="n">previous</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result_data</span> <span class="o">=</span> <span class="n">op</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">)):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">complex</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;complex(</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">real</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">imag</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ndarray</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">):</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;dask.array</span><span class="si">{</span><span class="n">other</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">other_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

            <span class="n">updated_channel_metadata</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">self_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">ch</span> <span class="o">=</span> <span class="n">self_ch</span><span class="o">.</span><span class="n">model_copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">ch</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">self_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">updated_channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>

            <span class="n">operation_history</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">symbol</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span><span class="p">:</span> <span class="n">other_str</span><span class="p">})</span>

            <span class="k">return</span> <span class="n">SpectrogramFrame</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">result_data</span><span class="p">,</span>
                <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
                <span class="n">hop_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span><span class="p">,</span>
                <span class="n">win_length</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">win_length</span><span class="p">,</span>
                <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">other_str</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
                <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="n">channel_metadata</span><span class="o">=</span><span class="n">updated_channel_metadata</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrogram&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the spectrogram using various visualization strategies.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str, default=&quot;spectrogram&quot;</span>
<span class="sd">            Type of plot to create.</span>
<span class="sd">        ax : matplotlib.axes.Axes, optional</span>
<span class="sd">            Axes to plot on. If None, creates new axes.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">            Common options include:</span>
<span class="sd">            - vmin, vmax: Colormap scaling</span>
<span class="sd">            - cmap: Colormap name</span>
<span class="sd">            - dB: Whether to plot in decibels</span>
<span class="sd">            - Aw: Whether to apply A-weighting</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Axes, Iterator[Axes]]</span>
<span class="sd">            The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">            for multi-plot outputs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

        <span class="c1"># プロット戦略を取得</span>
        <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectrogramFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># プロット実行</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_ax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot_Aw</span><span class="p">(</span>  <span class="c1"># noqa: N802</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrogram&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the A-weighted spectrogram.</span>

<span class="sd">        A convenience method that calls plot() with Aw=True, applying A-weighting</span>
<span class="sd">        to the spectrogram before plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str, default=&quot;spectrogram&quot;</span>
<span class="sd">            Type of plot to create.</span>
<span class="sd">        ax : matplotlib.axes.Axes, optional</span>
<span class="sd">            Axes to plot on. If None, creates new axes.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments passed to plot().</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Axes, Iterator[Axes]]</span>
<span class="sd">            The matplotlib axes containing the plot.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">Aw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_frame_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract spectral data at a specific time frame.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        time_idx : int</span>
<span class="sd">            Index of the time frame to extract.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        SpectralFrame</span>
<span class="sd">            A new SpectralFrame containing the spectral data at the specified time.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        IndexError</span>
<span class="sd">            If time_idx is out of range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>

        <span class="k">if</span> <span class="n">time_idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">time_idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;時間インデックス </span><span class="si">{</span><span class="n">time_idx</span><span class="si">}</span><span class="s2"> が範囲外です。有効範囲: 0-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: E501</span>
            <span class="p">)</span>

        <span class="n">frame_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">frame_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> (Frame </span><span class="si">{</span><span class="n">time_idx</span><span class="si">}</span><span class="s2">, Time </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">to_channel_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert the spectrogram back to time domain using inverse STFT.</span>

<span class="sd">        This method performs an inverse Short-Time Fourier Transform (ISTFT) to</span>
<span class="sd">        reconstruct the time-domain signal from the spectrogram.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        ChannelFrame</span>
<span class="sd">            A new ChannelFrame containing the reconstructed time-domain signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ISTFT</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;istft&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># 操作インスタンスを作成</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;ISTFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># データに処理を適用</span>
        <span class="n">time_series</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new ChannelFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># 新しいインスタンスを作成</span>
        <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">time_series</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;istft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_additional_init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get additional initialization arguments for SpectrogramFrame.</span>

<span class="sd">        This internal method provides the additional initialization arguments</span>
<span class="sd">        required by SpectrogramFrame beyond those required by BaseFrame.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict[str, Any]</span>
<span class="sd">            Additional initialization arguments.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h3 id="wandas.frames.spectrogram.SpectrogramFrame-attributes">Attributes<a href="#wandas.frames.spectrogram.SpectrogramFrame-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.n_fft" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.n_fft" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.hop_length" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">hop_length</span> <span class="o">=</span> <span class="n">hop_length</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.hop_length" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.win_length" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">win_length</span> <span class="o">=</span> <span class="n">win_length</span> <span class="k">if</span> <span class="n">win_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.win_length" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.window" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">window</span> <span class="o">=</span> <span class="n">window</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.window" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.magnitude" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">magnitude</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.magnitude" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the magnitude spectrogram.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.magnitude--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.magnitude--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The absolute values of the complex spectrogram.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.phase" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">phase</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.phase" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the phase spectrogram.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.phase--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.phase--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The phase angles of the complex spectrogram in radians.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.power" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">power</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.power" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the power spectrogram.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.power--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.power--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The squared magnitude of the complex spectrogram.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.dB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dB</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.dB" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the spectrogram in decibels relative to each channel's reference value.</p>
<p>The reference value for each channel is specified in its metadata.
A minimum value of -120 dB is enforced to avoid numerical issues.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.dB--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.dB--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The spectrogram in decibels.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.dBA" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dBA</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.dBA" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the A-weighted spectrogram in decibels.</p>
<p>A-weighting applies a frequency-dependent weighting filter that approximates
the human ear's response. This is particularly useful for analyzing noise
and acoustic measurements.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.dBA--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.dBA--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The A-weighted spectrogram in decibels.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.n_frames" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_frames</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.n_frames" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the number of time frames.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.n_frames--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.n_frames--returns" title="Permanent link">&para;</a></h6>
<p>int
    The number of time frames in the spectrogram.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n_freq_bins</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the number of frequency bins.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.n_freq_bins--returns" title="Permanent link">&para;</a></h6>
<p>int
    The number of frequency bins (n_fft // 2 + 1).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.freqs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">freqs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.freqs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the frequency axis values in Hz.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.freqs--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.freqs--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    Array of frequency values corresponding to each frequency bin.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.spectrogram.SpectrogramFrame.times" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">times</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.times" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the time axis values in seconds.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.times--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.times--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    Array of time values corresponding to each time frame.</p>

    </div>

</div>

<h3 id="wandas.frames.spectrogram.SpectrogramFrame-functions">Functions<a href="#wandas.frames.spectrogram.SpectrogramFrame-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectrogram.SpectrogramFrame.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">,</span> <span class="n">hop_length</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operation_history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channel_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># type: ignore [unused-ignore]</span>
    <span class="k">elif</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;データは2次元または3次元である必要があります。形状: </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">n_fft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;データの形状が無効です。周波数ビン数は </span><span class="si">{</span><span class="n">n_fft</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> である必要があります。&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span> <span class="o">=</span> <span class="n">hop_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">win_length</span> <span class="o">=</span> <span class="n">win_length</span> <span class="k">if</span> <span class="n">win_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">window</span> <span class="o">=</span> <span class="n">window</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectrogram.SpectrogramFrame.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;spectrogram&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.plot" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the spectrogram using various visualization strategies.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.plot--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.plot--parameters" title="Permanent link">&para;</a></h6>
<p>plot_type : str, default="spectrogram"
    Type of plot to create.
ax : matplotlib.axes.Axes, optional
    Axes to plot on. If None, creates new axes.
**kwargs : dict
    Additional keyword arguments passed to the plot strategy.
    Common options include:
    - vmin, vmax: Colormap scaling
    - cmap: Colormap name
    - dB: Whether to plot in decibels
    - Aw: Whether to apply A-weighting</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.plot--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.plot--returns" title="Permanent link">&para;</a></h6>
<p>Union[Axes, Iterator[Axes]]
    The matplotlib axes containing the plot, or an iterator of axes
    for multi-plot outputs.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrogram&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the spectrogram using various visualization strategies.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str, default=&quot;spectrogram&quot;</span>
<span class="sd">        Type of plot to create.</span>
<span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<span class="sd">        Axes to plot on. If None, creates new axes.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">        Common options include:</span>
<span class="sd">        - vmin, vmax: Colormap scaling</span>
<span class="sd">        - cmap: Colormap name</span>
<span class="sd">        - dB: Whether to plot in decibels</span>
<span class="sd">        - Aw: Whether to apply A-weighting</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Axes, Iterator[Axes]]</span>
<span class="sd">        The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">        for multi-plot outputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

    <span class="c1"># プロット戦略を取得</span>
    <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">SpectrogramFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># プロット実行</span>
    <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectrogram.SpectrogramFrame.plot_Aw" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot_Aw</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;spectrogram&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the A-weighted spectrogram.</p>
<p>A convenience method that calls plot() with Aw=True, applying A-weighting
to the spectrogram before plotting.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--parameters" title="Permanent link">&para;</a></h6>
<p>plot_type : str, default="spectrogram"
    Type of plot to create.
ax : matplotlib.axes.Axes, optional
    Axes to plot on. If None, creates new axes.
**kwargs : dict
    Additional keyword arguments passed to plot().</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.plot_Aw--returns" title="Permanent link">&para;</a></h6>
<p>Union[Axes, Iterator[Axes]]
    The matplotlib axes containing the plot.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot_Aw</span><span class="p">(</span>  <span class="c1"># noqa: N802</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrogram&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the A-weighted spectrogram.</span>

<span class="sd">    A convenience method that calls plot() with Aw=True, applying A-weighting</span>
<span class="sd">    to the spectrogram before plotting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str, default=&quot;spectrogram&quot;</span>
<span class="sd">        Type of plot to create.</span>
<span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<span class="sd">        Axes to plot on. If None, creates new axes.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to plot().</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Axes, Iterator[Axes]]</span>
<span class="sd">        The matplotlib axes containing the plot.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="n">plot_type</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">Aw</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectrogram.SpectrogramFrame.get_frame_at" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_frame_at</span><span class="p">(</span><span class="n">time_idx</span><span class="p">)</span></code>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extract spectral data at a specific time frame.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--parameters">Parameters<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--parameters" title="Permanent link">&para;</a></h6>
<p>time_idx : int
    Index of the time frame to extract.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--returns" title="Permanent link">&para;</a></h6>
<p>SpectralFrame
    A new SpectralFrame containing the spectral data at the specified time.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--raises">Raises<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.get_frame_at--raises" title="Permanent link">&para;</a></h6>
<p>IndexError
    If time_idx is out of range.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_frame_at</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract spectral data at a specific time frame.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    time_idx : int</span>
<span class="sd">        Index of the time frame to extract.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    SpectralFrame</span>
<span class="sd">        A new SpectralFrame containing the spectral data at the specified time.</span>

<span class="sd">    Raises</span>
<span class="sd">    ------</span>
<span class="sd">    IndexError</span>
<span class="sd">        If time_idx is out of range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>

    <span class="k">if</span> <span class="n">time_idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">time_idx</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;時間インデックス </span><span class="si">{</span><span class="n">time_idx</span><span class="si">}</span><span class="s2"> が範囲外です。有効範囲: 0-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">n_frames</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>

    <span class="n">frame_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_idx</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">frame_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2"> (Frame </span><span class="si">{</span><span class="n">time_idx</span><span class="si">}</span><span class="s2">, Time </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">time_idx</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">s)&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">to_channel_frame</span><span class="p">()</span></code>

<a href="#wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Convert the spectrogram back to time domain using inverse STFT.</p>
<p>This method performs an inverse Short-Time Fourier Transform (ISTFT) to
reconstruct the time-domain signal from the spectrogram.</p>
<h6 id="wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame--returns">Returns<a class="headerlink" href="#wandas.frames.spectrogram.SpectrogramFrame.to_channel_frame--returns" title="Permanent link">&para;</a></h6>
<p>ChannelFrame
    A new ChannelFrame containing the reconstructed time-domain signal.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/spectrogram.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">to_channel_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;ChannelFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert the spectrogram back to time domain using inverse STFT.</span>

<span class="sd">    This method performs an inverse Short-Time Fourier Transform (ISTFT) to</span>
<span class="sd">    reconstruct the time-domain signal from the spectrogram.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    ChannelFrame</span>
<span class="sd">        A new ChannelFrame containing the reconstructed time-domain signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.channel</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelFrame</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ISTFT</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hop_length</span><span class="p">,</span>
        <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">win_length</span><span class="p">,</span>
        <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;istft&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># 操作インスタンスを作成</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;ISTFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># データに処理を適用</span>
    <span class="n">time_series</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new ChannelFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># 新しいインスタンスを作成</span>
    <span class="k">return</span> <span class="n">ChannelFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">time_series</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;istft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="noctframe">NOctFrame<a class="headerlink" href="#noctframe" title="Permanent link">&para;</a></h2>
<p>NOctFrame is a frame class for octave-band analysis.</p>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.noct.NOctFrame" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.noct.NOctFrame</code>


<a href="#wandas.frames.noct.NOctFrame" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            BaseFrame (wandas.core.base_frame.BaseFrame)" href="../../../api/#wandas.core.base_frame.BaseFrame">BaseFrame</a>[<a class="autorefs autorefs-internal" title="            NDArrayReal = npt.NDArray[Real]

  
      module-attribute
   (wandas.utils.types.NDArrayReal)" href="../../../api/#wandas.utils.types.NDArrayReal">NDArrayReal</a>]</code></p>


        <p>Class for handling N-octave band analysis data.</p>
<p>This class represents frequency data analyzed in fractional octave bands,
typically used in acoustic and vibration analysis. It handles real-valued
data representing energy or power in each frequency band, following standard
acoustical band definitions.</p>
<h4 id="wandas.frames.noct.NOctFrame--parameters">Parameters<a class="headerlink" href="#wandas.frames.noct.NOctFrame--parameters" title="Permanent link">&para;</a></h4>
<p>data : DaArray
    The N-octave band data. Must be a dask array with shape:
    - (channels, frequency_bins) for multi-channel data
    - (frequency_bins,) for single-channel data, which will be
      reshaped to (1, frequency_bins)
sampling_rate : float
    The sampling rate of the original time-domain signal in Hz.
fmin : float, default=0
    Lower frequency bound in Hz.
fmax : float, default=0
    Upper frequency bound in Hz.
n : int, default=3
    Number of bands per octave (e.g., 3 for third-octave bands).
G : int, default=10
    Reference band number according to IEC 61260-1:2014.
fr : int, default=1000
    Reference frequency in Hz, typically 1000 Hz for acoustic analysis.
label : str, optional
    A label for the frame.
metadata : dict, optional
    Additional metadata for the frame.
operation_history : list[dict], optional
    History of operations performed on this frame.
channel_metadata : list[ChannelMetadata], optional
    Metadata for each channel in the frame.
previous : BaseFrame, optional
    The frame that this frame was derived from.</p>
<h4 id="wandas.frames.noct.NOctFrame--attributes">Attributes<a class="headerlink" href="#wandas.frames.noct.NOctFrame--attributes" title="Permanent link">&para;</a></h4>
<p>freqs : NDArrayReal
    The center frequencies of each band in Hz, calculated according to
    the standard fractional octave band definitions.
dB : NDArrayReal
    The spectrum in decibels relative to channel reference values.
dBA : NDArrayReal
    The A-weighted spectrum in decibels, applying frequency weighting
    for better correlation with perceived loudness.
fmin : float
    Lower frequency bound in Hz.
fmax : float
    Upper frequency bound in Hz.
n : int
    Number of bands per octave.
G : int
    Reference band number.
fr : int
    Reference frequency in Hz.</p>
<h4 id="wandas.frames.noct.NOctFrame--examples">Examples<a class="headerlink" href="#wandas.frames.noct.NOctFrame--examples" title="Permanent link">&para;</a></h4>
<p>Create an N-octave band spectrum from a time-domain signal:</p>
<blockquote>
<blockquote>
<blockquote>
<p>signal = ChannelFrame.from_wav("audio.wav")
spectrum = signal.noct_spectrum(fmin=20, fmax=20000, n=3)</p>
</blockquote>
</blockquote>
</blockquote>
<p>Plot the N-octave band spectrum:</p>
<blockquote>
<blockquote>
<blockquote>
<p>spectrum.plot()</p>
</blockquote>
</blockquote>
</blockquote>
<p>Plot with A-weighting applied:</p>
<blockquote>
<blockquote>
<blockquote>
<p>spectrum.plot(Aw=True)</p>
</blockquote>
</blockquote>
</blockquote>
<h4 id="wandas.frames.noct.NOctFrame--notes">Notes<a class="headerlink" href="#wandas.frames.noct.NOctFrame--notes" title="Permanent link">&para;</a></h4>
<ul>
<li>Binary operations (addition, multiplication, etc.) are not currently
  supported for N-octave band data.</li>
<li>The actual frequency bands are determined by the parameters n, G, and fr
  according to IEC 61260-1:2014 standard for fractional octave band filters.</li>
<li>The class follows acoustic standards for band definitions and analysis,
  making it suitable for noise measurements and sound level analysis.</li>
<li>A-weighting is available for better correlation with human hearing
  perception, following IEC 61672-1:2013.</li>
</ul>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/noct.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">NOctFrame</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">NDArrayReal</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for handling N-octave band analysis data.</span>

<span class="sd">    This class represents frequency data analyzed in fractional octave bands,</span>
<span class="sd">    typically used in acoustic and vibration analysis. It handles real-valued</span>
<span class="sd">    data representing energy or power in each frequency band, following standard</span>
<span class="sd">    acoustical band definitions.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : DaArray</span>
<span class="sd">        The N-octave band data. Must be a dask array with shape:</span>
<span class="sd">        - (channels, frequency_bins) for multi-channel data</span>
<span class="sd">        - (frequency_bins,) for single-channel data, which will be</span>
<span class="sd">          reshaped to (1, frequency_bins)</span>
<span class="sd">    sampling_rate : float</span>
<span class="sd">        The sampling rate of the original time-domain signal in Hz.</span>
<span class="sd">    fmin : float, default=0</span>
<span class="sd">        Lower frequency bound in Hz.</span>
<span class="sd">    fmax : float, default=0</span>
<span class="sd">        Upper frequency bound in Hz.</span>
<span class="sd">    n : int, default=3</span>
<span class="sd">        Number of bands per octave (e.g., 3 for third-octave bands).</span>
<span class="sd">    G : int, default=10</span>
<span class="sd">        Reference band number according to IEC 61260-1:2014.</span>
<span class="sd">    fr : int, default=1000</span>
<span class="sd">        Reference frequency in Hz, typically 1000 Hz for acoustic analysis.</span>
<span class="sd">    label : str, optional</span>
<span class="sd">        A label for the frame.</span>
<span class="sd">    metadata : dict, optional</span>
<span class="sd">        Additional metadata for the frame.</span>
<span class="sd">    operation_history : list[dict], optional</span>
<span class="sd">        History of operations performed on this frame.</span>
<span class="sd">    channel_metadata : list[ChannelMetadata], optional</span>
<span class="sd">        Metadata for each channel in the frame.</span>
<span class="sd">    previous : BaseFrame, optional</span>
<span class="sd">        The frame that this frame was derived from.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    freqs : NDArrayReal</span>
<span class="sd">        The center frequencies of each band in Hz, calculated according to</span>
<span class="sd">        the standard fractional octave band definitions.</span>
<span class="sd">    dB : NDArrayReal</span>
<span class="sd">        The spectrum in decibels relative to channel reference values.</span>
<span class="sd">    dBA : NDArrayReal</span>
<span class="sd">        The A-weighted spectrum in decibels, applying frequency weighting</span>
<span class="sd">        for better correlation with perceived loudness.</span>
<span class="sd">    fmin : float</span>
<span class="sd">        Lower frequency bound in Hz.</span>
<span class="sd">    fmax : float</span>
<span class="sd">        Upper frequency bound in Hz.</span>
<span class="sd">    n : int</span>
<span class="sd">        Number of bands per octave.</span>
<span class="sd">    G : int</span>
<span class="sd">        Reference band number.</span>
<span class="sd">    fr : int</span>
<span class="sd">        Reference frequency in Hz.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    Create an N-octave band spectrum from a time-domain signal:</span>
<span class="sd">    &gt;&gt;&gt; signal = ChannelFrame.from_wav(&quot;audio.wav&quot;)</span>
<span class="sd">    &gt;&gt;&gt; spectrum = signal.noct_spectrum(fmin=20, fmax=20000, n=3)</span>

<span class="sd">    Plot the N-octave band spectrum:</span>
<span class="sd">    &gt;&gt;&gt; spectrum.plot()</span>

<span class="sd">    Plot with A-weighting applied:</span>
<span class="sd">    &gt;&gt;&gt; spectrum.plot(Aw=True)</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - Binary operations (addition, multiplication, etc.) are not currently</span>
<span class="sd">      supported for N-octave band data.</span>
<span class="sd">    - The actual frequency bands are determined by the parameters n, G, and fr</span>
<span class="sd">      according to IEC 61260-1:2014 standard for fractional octave band filters.</span>
<span class="sd">    - The class follows acoustic standards for band definitions and analysis,</span>
<span class="sd">      making it suitable for noise measurements and sound level analysis.</span>
<span class="sd">    - A-weighting is available for better correlation with human hearing</span>
<span class="sd">      perception, following IEC 61672-1:2013.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">G</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a NOctFrame instance.</span>

<span class="sd">        Sets up N-octave band analysis parameters and prepares the frame for</span>
<span class="sd">        storing band-filtered data. Data shape is validated to ensure compatibility</span>
<span class="sd">        with N-octave band analysis.</span>

<span class="sd">        See class docstring for parameter descriptions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">G</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="n">fr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dB</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the spectrum in decibels relative to each channel&#39;s reference value.</span>

<span class="sd">        The reference value for each channel is specified in its metadata.</span>
<span class="sd">        A minimum value of -120 dB is enforced to avoid numerical issues.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The spectrum in decibels. Shape matches the input data shape:</span>
<span class="sd">            (channels, frequency_bins).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Collect dB reference values from _channel_metadata</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">ch</span><span class="o">.</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">])</span>
        <span class="c1"># Convert to dB</span>
        <span class="c1"># Use either the maximum value or 1e-12 to avoid division by zero</span>
        <span class="n">level</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">/</span> <span class="n">ref</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">],</span> <span class="mf">1e-12</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">level</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dBA</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>  <span class="c1"># noqa: N802</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the A-weighted spectrum in decibels.</span>

<span class="sd">        A-weighting applies a frequency-dependent weighting filter that approximates</span>
<span class="sd">        the human ear&#39;s response to different frequencies. This is particularly useful</span>
<span class="sd">        for analyzing noise and acoustic measurements as it provides a better</span>
<span class="sd">        correlation with perceived loudness.</span>

<span class="sd">        The weighting is applied according to IEC 61672-1:2013 standard.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            The A-weighted spectrum in decibels. Shape matches the input data shape:</span>
<span class="sd">            (channels, frequency_bins).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Collect dB reference values from _channel_metadata</span>
        <span class="n">weighted</span><span class="p">:</span> <span class="n">NDArrayReal</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">A_weighting</span><span class="p">(</span><span class="n">frequencies</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">freqs</span><span class="p">,</span> <span class="n">min_db</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dB</span> <span class="o">+</span> <span class="n">weighted</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_n_channels</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the number of channels in the data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The number of channels in the N-octave band data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">freqs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArrayReal</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the center frequencies of each band in Hz.</span>

<span class="sd">        These frequencies are calculated based on the N-octave band parameters</span>
<span class="sd">        (n, G, fr) and the frequency bounds (fmin, fmax) according to</span>
<span class="sd">        IEC 61260-1:2014 standard for fractional octave band filters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        NDArrayReal</span>
<span class="sd">            Array of center frequencies for each frequency band.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the center frequencies cannot be calculated or the result</span>
<span class="sd">            is not a numpy array.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">freqs</span> <span class="o">=</span> <span class="n">_center_freq</span><span class="p">(</span>
            <span class="n">fmax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span>
            <span class="n">fmin</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
            <span class="n">G</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span>
            <span class="n">fr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fr</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">freqs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;freqs is not numpy array.&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_binary_op</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span>
        <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">S</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">NDArrayReal</span><span class="p">,</span> <span class="n">DaArray</span><span class="p">],</span>
        <span class="n">op</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">DaArray</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">DaArray</span><span class="p">],</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Binary operations are not currently supported for N-octave band data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        other : Union[S, int, float, NDArrayReal, DaArray]</span>
<span class="sd">            The right operand of the operation.</span>
<span class="sd">        op : callable</span>
<span class="sd">            Function to execute the operation.</span>
<span class="sd">        symbol : str</span>
<span class="sd">            String representation of the operation (e.g., &#39;+&#39;, &#39;-&#39;, &#39;*&#39;, &#39;/&#39;).</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        NotImplementedError</span>
<span class="sd">            Always raises this error as operations are not implemented</span>
<span class="sd">            for N-octave band data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Operation </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> is not implemented for NOctFrame.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_apply_operation_impl</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">operation_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Apply operations using lazy evaluation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Apply operations using lazy evaluation</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> is not implemented for NOctFrame.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;noct&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the N-octave band data using various visualization strategies.</span>

<span class="sd">        Supports standard plotting configurations for acoustic analysis,</span>
<span class="sd">        including decibel scales and A-weighting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str, default=&quot;noct&quot;</span>
<span class="sd">            Type of plot to create. The default &quot;noct&quot; type creates a bar plot</span>
<span class="sd">            suitable for displaying N-octave band data.</span>
<span class="sd">        ax : matplotlib.axes.Axes, optional</span>
<span class="sd">            Axes to plot on. If None, creates new axes.</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">            Common options include:</span>
<span class="sd">            - dB: Whether to plot in decibels</span>
<span class="sd">            - Aw: Whether to apply A-weighting</span>
<span class="sd">            - title: Plot title</span>
<span class="sd">            - xlabel, ylabel: Axis labels</span>
<span class="sd">            - xscale: Set to &quot;log&quot; for logarithmic frequency axis</span>
<span class="sd">            - grid: Whether to show grid lines</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Union[Axes, Iterator[Axes]]</span>
<span class="sd">            The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">            for multi-plot outputs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

        <span class="c1"># Get plot strategy</span>
        <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">NOctFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

        <span class="c1"># Execute plot</span>
        <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">_ax</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_additional_init_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get additional initialization arguments for NOctFrame.</span>

<span class="sd">        This internal method provides the additional initialization arguments</span>
<span class="sd">        required by NOctFrame beyond those required by BaseFrame. These include</span>
<span class="sd">        the N-octave band analysis parameters that define the frequency bands.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict[str, Any]</span>
<span class="sd">            Additional initialization arguments specific to NOctFrame:</span>
<span class="sd">            - n: Number of bands per octave</span>
<span class="sd">            - G: Reference band number</span>
<span class="sd">            - fr: Reference frequency</span>
<span class="sd">            - fmin: Lower frequency bound</span>
<span class="sd">            - fmax: Upper frequency bound</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">n</span><span class="p">,</span>
            <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">,</span>
            <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fr</span><span class="p">,</span>
            <span class="s2">&quot;fmin&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span><span class="p">,</span>
            <span class="s2">&quot;fmax&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span><span class="p">,</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">





<h3 id="wandas.frames.noct.NOctFrame-attributes">Attributes<a href="#wandas.frames.noct.NOctFrame-attributes" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.n" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">n</span> <span class="o">=</span> <span class="n">n</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.n" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.G" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">G</span> <span class="o">=</span> <span class="n">G</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.G" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.fr" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">fr</span> <span class="o">=</span> <span class="n">fr</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.fr" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.fmin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.fmin" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.fmax" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.fmax" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.dB" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dB</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.dB" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the spectrum in decibels relative to each channel's reference value.</p>
<p>The reference value for each channel is specified in its metadata.
A minimum value of -120 dB is enforced to avoid numerical issues.</p>
<h6 id="wandas.frames.noct.NOctFrame.dB--returns">Returns<a class="headerlink" href="#wandas.frames.noct.NOctFrame.dB--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The spectrum in decibels. Shape matches the input data shape:
    (channels, frequency_bins).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.dBA" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">dBA</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.dBA" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the A-weighted spectrum in decibels.</p>
<p>A-weighting applies a frequency-dependent weighting filter that approximates
the human ear's response to different frequencies. This is particularly useful
for analyzing noise and acoustic measurements as it provides a better
correlation with perceived loudness.</p>
<p>The weighting is applied according to IEC 61672-1:2013 standard.</p>
<h6 id="wandas.frames.noct.NOctFrame.dBA--returns">Returns<a class="headerlink" href="#wandas.frames.noct.NOctFrame.dBA--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    The A-weighted spectrum in decibels. Shape matches the input data shape:
    (channels, frequency_bins).</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="wandas.frames.noct.NOctFrame.freqs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-attribute"></code>            <code class="highlight language-python"><span class="n">freqs</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#wandas.frames.noct.NOctFrame.freqs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Get the center frequencies of each band in Hz.</p>
<p>These frequencies are calculated based on the N-octave band parameters
(n, G, fr) and the frequency bounds (fmin, fmax) according to
IEC 61260-1:2014 standard for fractional octave band filters.</p>
<h6 id="wandas.frames.noct.NOctFrame.freqs--returns">Returns<a class="headerlink" href="#wandas.frames.noct.NOctFrame.freqs--returns" title="Permanent link">&para;</a></h6>
<p>NDArrayReal
    Array of center frequencies for each frequency band.</p>
<h6 id="wandas.frames.noct.NOctFrame.freqs--raises">Raises<a class="headerlink" href="#wandas.frames.noct.NOctFrame.freqs--raises" title="Permanent link">&para;</a></h6>
<p>ValueError
    If the center frequencies cannot be calculated or the result
    is not a numpy array.</p>

    </div>

</div>

<h3 id="wandas.frames.noct.NOctFrame-functions">Functions<a href="#wandas.frames.noct.NOctFrame-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.noct.NOctFrame.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sampling_rate</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fr</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operation_history</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channel_metadata</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">previous</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.noct.NOctFrame.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Initialize a NOctFrame instance.</p>
<p>Sets up N-octave band analysis parameters and prepares the frame for
storing band-filtered data. Data shape is validated to ensure compatibility
with N-octave band analysis.</p>
<p>See class docstring for parameter descriptions.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/noct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">DaArray</span><span class="p">,</span>
    <span class="n">sampling_rate</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">operation_history</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">channel_metadata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">ChannelMetadata</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">previous</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;BaseFrame[Any]&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize a NOctFrame instance.</span>

<span class="sd">    Sets up N-octave band analysis parameters and prepares the frame for</span>
<span class="sd">    storing band-filtered data. Data shape is validated to ensure compatibility</span>
<span class="sd">    with N-octave band analysis.</span>

<span class="sd">    See class docstring for parameter descriptions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">n</span> <span class="o">=</span> <span class="n">n</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">G</span> <span class="o">=</span> <span class="n">G</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fr</span> <span class="o">=</span> <span class="n">fr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fmin</span> <span class="o">=</span> <span class="n">fmin</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">fmax</span> <span class="o">=</span> <span class="n">fmax</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">previous</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.noct.NOctFrame.plot" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="n">plot_type</span><span class="o">=</span><span class="s1">&#39;noct&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.noct.NOctFrame.plot" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Plot the N-octave band data using various visualization strategies.</p>
<p>Supports standard plotting configurations for acoustic analysis,
including decibel scales and A-weighting.</p>
<h6 id="wandas.frames.noct.NOctFrame.plot--parameters">Parameters<a class="headerlink" href="#wandas.frames.noct.NOctFrame.plot--parameters" title="Permanent link">&para;</a></h6>
<p>plot_type : str, default="noct"
    Type of plot to create. The default "noct" type creates a bar plot
    suitable for displaying N-octave band data.
ax : matplotlib.axes.Axes, optional
    Axes to plot on. If None, creates new axes.
**kwargs : dict
    Additional keyword arguments passed to the plot strategy.
    Common options include:
    - dB: Whether to plot in decibels
    - Aw: Whether to apply A-weighting
    - title: Plot title
    - xlabel, ylabel: Axis labels
    - xscale: Set to "log" for logarithmic frequency axis
    - grid: Whether to show grid lines</p>
<h6 id="wandas.frames.noct.NOctFrame.plot--returns">Returns<a class="headerlink" href="#wandas.frames.noct.NOctFrame.plot--returns" title="Permanent link">&para;</a></h6>
<p>Union[Axes, Iterator[Axes]]
    The matplotlib axes containing the plot, or an iterator of axes
    for multi-plot outputs.</p>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/noct.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">plot</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;noct&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">[</span><span class="s2">&quot;Axes&quot;</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the N-octave band data using various visualization strategies.</span>

<span class="sd">    Supports standard plotting configurations for acoustic analysis,</span>
<span class="sd">    including decibel scales and A-weighting.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str, default=&quot;noct&quot;</span>
<span class="sd">        Type of plot to create. The default &quot;noct&quot; type creates a bar plot</span>
<span class="sd">        suitable for displaying N-octave band data.</span>
<span class="sd">    ax : matplotlib.axes.Axes, optional</span>
<span class="sd">        Axes to plot on. If None, creates new axes.</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional keyword arguments passed to the plot strategy.</span>
<span class="sd">        Common options include:</span>
<span class="sd">        - dB: Whether to plot in decibels</span>
<span class="sd">        - Aw: Whether to apply A-weighting</span>
<span class="sd">        - title: Plot title</span>
<span class="sd">        - xlabel, ylabel: Axis labels</span>
<span class="sd">        - xscale: Set to &quot;log&quot; for logarithmic frequency axis</span>
<span class="sd">        - grid: Whether to show grid lines</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Union[Axes, Iterator[Axes]]</span>
<span class="sd">        The matplotlib axes containing the plot, or an iterator of axes</span>
<span class="sd">        for multi-plot outputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.visualization.plotting</span><span class="w"> </span><span class="kn">import</span> <span class="n">create_operation</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Plotting audio with plot_type=</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2"> (will compute now)&quot;</span><span class="p">)</span>

    <span class="c1"># Get plot strategy</span>
    <span class="n">plot_strategy</span><span class="p">:</span> <span class="n">PlotStrategy</span><span class="p">[</span><span class="n">NOctFrame</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>

    <span class="c1"># Execute plot</span>
    <span class="n">_ax</span> <span class="o">=</span> <span class="n">plot_strategy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Plot rendering complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_ax</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h2 id="mixins">Mixins<a class="headerlink" href="#mixins" title="Permanent link">&para;</a></h2>
<p>Mixins for extending frame functionality.</p>
<h3 id="channelprocessingmixin">ChannelProcessingMixin<a class="headerlink" href="#channelprocessingmixin" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin</code>


<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>Mixin that provides methods related to signal processing.</p>
<p>This mixin provides processing methods applied to audio signals and
other time-series data, such as signal processing filters and
transformation operations.</p>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChannelProcessingMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin that provides methods related to signal processing.</span>

<span class="sd">    This mixin provides processing methods applied to audio signals and</span>
<span class="sd">    other time-series data, such as signal processing filters and</span>
<span class="sd">    transformation operations.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">high_pass_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a high-pass filter to the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            cutoff: Filter cutoff frequency (Hz)</span>
<span class="sd">            order: Filter order. Default is 4.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame after filter application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Setting up highpass filter: cutoff=</span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;highpass_filter&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">low_pass_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a low-pass filter to the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            cutoff: Filter cutoff frequency (Hz)</span>
<span class="sd">            order: Filter order. Default is 4.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame after filter application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Setting up lowpass filter: cutoff=</span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;lowpass_filter&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">band_pass_filter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">low_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">high_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply a band-pass filter to the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            low_cutoff: Lower cutoff frequency (Hz)</span>
<span class="sd">            high_cutoff: Higher cutoff frequency (Hz)</span>
<span class="sd">            order: Filter order. Default is 4.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame after filter application</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Setting up bandpass filter: low_cutoff=</span><span class="si">{</span><span class="n">low_cutoff</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;high_cutoff=</span><span class="si">{</span><span class="n">high_cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;bandpass_filter&quot;</span><span class="p">,</span>
            <span class="n">low_cutoff</span><span class="o">=</span><span class="n">low_cutoff</span><span class="p">,</span>
            <span class="n">high_cutoff</span><span class="o">=</span><span class="n">high_cutoff</span><span class="p">,</span>
            <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">target_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">channel_wise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Normalize signal levels.</span>

<span class="sd">        This method adjusts the signal amplitude to reach the target RMS level.</span>

<span class="sd">        Args:</span>
<span class="sd">            target_level: Target RMS level (dB). Default is -20.</span>
<span class="sd">            channel_wise: If True, normalize each channel individually.</span>
<span class="sd">                If False, apply the same scaling to all channels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the normalized signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Setting up normalize: target_level=</span><span class="si">{</span><span class="n">target_level</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;channel_wise=</span><span class="si">{</span><span class="n">channel_wise</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
        <span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;normalize&quot;</span><span class="p">,</span> <span class="n">target_level</span><span class="o">=</span><span class="n">target_level</span><span class="p">,</span> <span class="n">channel_wise</span><span class="o">=</span><span class="n">channel_wise</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">a_weighting</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Apply A-weighting filter to the signal.</span>

<span class="sd">        A-weighting adjusts the frequency response to approximate human</span>
<span class="sd">        auditory perception, according to the IEC 61672-1:2013 standard.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the A-weighted signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;a_weighting&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the absolute value of the signal.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the absolute values</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;abs&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the power of the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            exponent: Exponent to raise the signal to. Default is 2.0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the powered signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="n">exponent</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sum all channels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame with summed signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Average all channels.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame with averaged signal.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">trim</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Trim the signal to the specified time range.</span>

<span class="sd">        Args:</span>
<span class="sd">            start: Start time (seconds)</span>
<span class="sd">            end: End time (seconds)</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the trimmed signal</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If end time is earlier than start time</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;start must be less than end&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;trim&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fix_length</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjust the signal to the specified length.</span>

<span class="sd">        Args:</span>
<span class="sd">            duration: Signal length in seconds</span>
<span class="sd">            length: Signal length in samples</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the adjusted signal</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;fix_length&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">rms_trend</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">frame_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
        <span class="n">dB</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="n">Aw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the RMS trend of the signal.</span>

<span class="sd">        This method calculates the root mean square value over a sliding window.</span>

<span class="sd">        Args:</span>
<span class="sd">            frame_length: Size of the sliding window in samples. Default is 2048.</span>
<span class="sd">            hop_length: Hop length between windows in samples. Default is 512.</span>
<span class="sd">            dB: Whether to return RMS values in decibels. Default is False.</span>
<span class="sd">            Aw: Whether to apply A-weighting. Default is False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the RMS trend</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Access _channel_metadata to retrieve reference values</span>
        <span class="n">frame</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ProcessingFrameProtocol</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Ensure _channel_metadata exists before referencing</span>
        <span class="n">ref_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;_channel_metadata&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">frame</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="n">ref_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;rms_trend&quot;</span><span class="p">,</span>
            <span class="n">frame_length</span><span class="o">=</span><span class="n">frame_length</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="n">ref</span><span class="o">=</span><span class="n">ref_values</span><span class="p">,</span>
            <span class="n">dB</span><span class="o">=</span><span class="n">dB</span><span class="p">,</span>
            <span class="n">Aw</span><span class="o">=</span><span class="n">Aw</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Update sampling rate</span>
        <span class="n">result_obj</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">result_obj</span><span class="p">,</span> <span class="s2">&quot;sampling_rate&quot;</span><span class="p">):</span>
            <span class="n">result_obj</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">/</span> <span class="n">hop_length</span>

        <span class="k">return</span> <span class="n">result_obj</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">channel_difference</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">other_channel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute the difference between channels.</span>

<span class="sd">        Args:</span>
<span class="sd">            other_channel: Index or label of the reference channel. Default is 0.</span>

<span class="sd">        Returns:</span>
<span class="sd">            New ChannelFrame containing the channel difference</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># label2index is a method of BaseFrame</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_channel</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;label2index&quot;</span><span class="p">):</span>
                <span class="n">other_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label2index</span><span class="p">(</span><span class="n">other_channel</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;channel_difference&quot;</span><span class="p">,</span> <span class="n">other_channel</span><span class="o">=</span><span class="n">other_channel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resampling</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">target_sr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resample audio data.</span>

<span class="sd">        Args:</span>
<span class="sd">            target_sr: Target sampling rate (Hz)</span>
<span class="sd">            **kwargs: Additional resampling parameters</span>

<span class="sd">        Returns:</span>
<span class="sd">            Resampled ChannelFrame</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
            <span class="n">T_Processing</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
                <span class="s2">&quot;resampling&quot;</span><span class="p">,</span>
                <span class="n">target_sr</span><span class="o">=</span><span class="n">target_sr</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hpss_harmonic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
        <span class="n">power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">margin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span>
            <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
            <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="s2">&quot;_WindowSpec&quot;</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="p">:</span> <span class="s2">&quot;_PadModeSTFT&quot;</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract harmonic components using HPSS</span>
<span class="sd">         (Harmonic-Percussive Source Separation).</span>

<span class="sd">        This method separates the harmonic (tonal) components from the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            kernel_size: Median filter size for HPSS.</span>
<span class="sd">            power: Exponent for the Weiner filter used in HPSS.</span>
<span class="sd">            margin: Margin size for the separation.</span>
<span class="sd">            n_fft: Size of FFT window.</span>
<span class="sd">            hop_length: Hop length for STFT.</span>
<span class="sd">            win_length: Window length for STFT.</span>
<span class="sd">            window: Window type for STFT.</span>
<span class="sd">            center: If True, center the frames.</span>
<span class="sd">            pad_mode: Padding mode for STFT.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the harmonic components.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;hpss_harmonic&quot;</span><span class="p">,</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
            <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
            <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">hpss_percussive</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">]</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
        <span class="n">power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
        <span class="n">margin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
            <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span>
            <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
            <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
        <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="s2">&quot;_WindowSpec&quot;</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="p">:</span> <span class="s2">&quot;_PadModeSTFT&quot;</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract percussive components using HPSS</span>
<span class="sd">        (Harmonic-Percussive Source Separation).</span>

<span class="sd">        This method separates the percussive (tonal) components from the signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            kernel_size: Median filter size for HPSS.</span>
<span class="sd">            power: Exponent for the Weiner filter used in HPSS.</span>
<span class="sd">            margin: Margin size for the separation.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A new ChannelFrame containing the harmonic components.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;hpss_percussive&quot;</span><span class="p">,</span>
            <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
            <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
            <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
            <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<h3 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin-functions">Functions<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.high_pass_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">high_pass_filter</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.high_pass_filter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Apply a high-pass filter to the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter cutoff frequency (Hz)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter order. Default is 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame after filter application</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">high_pass_filter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a high-pass filter to the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        cutoff: Filter cutoff frequency (Hz)</span>
<span class="sd">        order: Filter order. Default is 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame after filter application</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Setting up highpass filter: cutoff=</span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;highpass_filter&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.low_pass_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">low_pass_filter</span><span class="p">(</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.low_pass_filter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Apply a low-pass filter to the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter cutoff frequency (Hz)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter order. Default is 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame after filter application</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">low_pass_filter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a low-pass filter to the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        cutoff: Filter cutoff frequency (Hz)</span>
<span class="sd">        order: Filter order. Default is 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame after filter application</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Setting up lowpass filter: cutoff=</span><span class="si">{</span><span class="n">cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;lowpass_filter&quot;</span><span class="p">,</span> <span class="n">cutoff</span><span class="o">=</span><span class="n">cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.band_pass_filter" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">band_pass_filter</span><span class="p">(</span><span class="n">low_cutoff</span><span class="p">,</span> <span class="n">high_cutoff</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.band_pass_filter" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Apply a band-pass filter to the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>low_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lower cutoff frequency (Hz)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>high_cutoff</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Higher cutoff frequency (Hz)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>order</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Filter order. Default is 4.</p>
              </div>
            </td>
            <td>
                  <code>4</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame after filter application</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">band_pass_filter</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">low_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">high_cutoff</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">order</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">4</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply a band-pass filter to the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        low_cutoff: Lower cutoff frequency (Hz)</span>
<span class="sd">        high_cutoff: Higher cutoff frequency (Hz)</span>
<span class="sd">        order: Filter order. Default is 4.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame after filter application</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Setting up bandpass filter: low_cutoff=</span><span class="si">{</span><span class="n">low_cutoff</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;high_cutoff=</span><span class="si">{</span><span class="n">high_cutoff</span><span class="si">}</span><span class="s2">, order=</span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
        <span class="s2">&quot;bandpass_filter&quot;</span><span class="p">,</span>
        <span class="n">low_cutoff</span><span class="o">=</span><span class="n">low_cutoff</span><span class="p">,</span>
        <span class="n">high_cutoff</span><span class="o">=</span><span class="n">high_cutoff</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.normalize" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">normalize</span><span class="p">(</span><span class="n">target_level</span><span class="o">=-</span><span class="mi">20</span><span class="p">,</span> <span class="n">channel_wise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.normalize" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Normalize signal levels.</p>
<p>This method adjusts the signal amplitude to reach the target RMS level.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_level</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target RMS level (dB). Default is -20.</p>
              </div>
            </td>
            <td>
                  <code>-20</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>channel_wise</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, normalize each channel individually.
If False, apply the same scaling to all channels.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the normalized signal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">normalize</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">target_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="n">channel_wise</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Normalize signal levels.</span>

<span class="sd">    This method adjusts the signal amplitude to reach the target RMS level.</span>

<span class="sd">    Args:</span>
<span class="sd">        target_level: Target RMS level (dB). Default is -20.</span>
<span class="sd">        channel_wise: If True, normalize each channel individually.</span>
<span class="sd">            If False, apply the same scaling to all channels.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the normalized signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Setting up normalize: target_level=</span><span class="si">{</span><span class="n">target_level</span><span class="si">}</span><span class="s2">, &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;channel_wise=</span><span class="si">{</span><span class="n">channel_wise</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span>
    <span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
        <span class="s2">&quot;normalize&quot;</span><span class="p">,</span> <span class="n">target_level</span><span class="o">=</span><span class="n">target_level</span><span class="p">,</span> <span class="n">channel_wise</span><span class="o">=</span><span class="n">channel_wise</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.a_weighting" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">a_weighting</span><span class="p">()</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.a_weighting" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Apply A-weighting filter to the signal.</p>
<p>A-weighting adjusts the frequency response to approximate human
auditory perception, according to the IEC 61672-1:2013 standard.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the A-weighted signal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">a_weighting</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Apply A-weighting filter to the signal.</span>

<span class="sd">    A-weighting adjusts the frequency response to approximate human</span>
<span class="sd">    auditory perception, according to the IEC 61672-1:2013 standard.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the A-weighted signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;a_weighting&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.abs" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="nb">abs</span><span class="p">()</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.abs" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the absolute value of the signal.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the absolute values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the absolute value of the signal.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the absolute values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;abs&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.power" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">power</span><span class="p">(</span><span class="n">exponent</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.power" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the power of the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>exponent</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent to raise the signal to. Default is 2.0.</p>
              </div>
            </td>
            <td>
                  <code>2.0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the powered signal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">power</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the power of the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        exponent: Exponent to raise the signal to. Default is 2.0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the powered signal</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;power&quot;</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="n">exponent</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.sum" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="nb">sum</span><span class="p">()</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.sum" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Sum all channels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame with summed signal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sum all channels.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame with summed signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;sum&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.mean" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">mean</span><span class="p">()</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.mean" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Average all channels.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame with averaged signal.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Average all channels.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame with averaged signal.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.trim" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">trim</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.trim" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Trim the signal to the specified time range.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Start time (seconds)</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>End time (seconds)</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the trimmed signal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If end time is earlier than start time</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">trim</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">start</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">end</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Trim the signal to the specified time range.</span>

<span class="sd">    Args:</span>
<span class="sd">        start: Start time (seconds)</span>
<span class="sd">        end: End time (seconds)</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the trimmed signal</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If end time is earlier than start time</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">end</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
    <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;start must be less than end&quot;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;trim&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.fix_length" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">fix_length</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.fix_length" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Adjust the signal to the specified length.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>duration</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="float">float</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal length in seconds</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Signal length in samples</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the adjusted signal</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fix_length</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adjust the signal to the specified length.</span>

<span class="sd">    Args:</span>
<span class="sd">        duration: Signal length in seconds</span>
<span class="sd">        length: Signal length in samples</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the adjusted signal</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;fix_length&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.rms_trend" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">rms_trend</span><span class="p">(</span><span class="n">frame_length</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="mi">512</span><span class="p">,</span> <span class="n">dB</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Aw</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.rms_trend" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the RMS trend of the signal.</p>
<p>This method calculates the root mean square value over a sliding window.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>frame_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of the sliding window in samples. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hop length between windows in samples. Default is 512.</p>
              </div>
            </td>
            <td>
                  <code>512</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dB</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to return RMS values in decibels. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Aw</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to apply A-weighting. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the RMS trend</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">rms_trend</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">frame_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">512</span><span class="p">,</span>
    <span class="n">dB</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="n">Aw</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the RMS trend of the signal.</span>

<span class="sd">    This method calculates the root mean square value over a sliding window.</span>

<span class="sd">    Args:</span>
<span class="sd">        frame_length: Size of the sliding window in samples. Default is 2048.</span>
<span class="sd">        hop_length: Hop length between windows in samples. Default is 512.</span>
<span class="sd">        dB: Whether to return RMS values in decibels. Default is False.</span>
<span class="sd">        Aw: Whether to apply A-weighting. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the RMS trend</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Access _channel_metadata to retrieve reference values</span>
    <span class="n">frame</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">ProcessingFrameProtocol</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Ensure _channel_metadata exists before referencing</span>
    <span class="n">ref_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="s2">&quot;_channel_metadata&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">frame</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
        <span class="n">ref_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">ch</span><span class="o">.</span><span class="n">ref</span> <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">frame</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">]</span>

    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
        <span class="s2">&quot;rms_trend&quot;</span><span class="p">,</span>
        <span class="n">frame_length</span><span class="o">=</span><span class="n">frame_length</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
        <span class="n">ref</span><span class="o">=</span><span class="n">ref_values</span><span class="p">,</span>
        <span class="n">dB</span><span class="o">=</span><span class="n">dB</span><span class="p">,</span>
        <span class="n">Aw</span><span class="o">=</span><span class="n">Aw</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Update sampling rate</span>
    <span class="n">result_obj</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">result_obj</span><span class="p">,</span> <span class="s2">&quot;sampling_rate&quot;</span><span class="p">):</span>
        <span class="n">result_obj</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="n">frame</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">/</span> <span class="n">hop_length</span>

    <span class="k">return</span> <span class="n">result_obj</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.channel_difference" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">channel_difference</span><span class="p">(</span><span class="n">other_channel</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.channel_difference" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Compute the difference between channels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>other_channel</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="int">int</span>, <span title="str">str</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Index or label of the reference channel. Default is 0.</p>
              </div>
            </td>
            <td>
                  <code>0</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>New ChannelFrame containing the channel difference</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">channel_difference</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span> <span class="n">other_channel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute the difference between channels.</span>

<span class="sd">    Args:</span>
<span class="sd">        other_channel: Index or label of the reference channel. Default is 0.</span>

<span class="sd">    Returns:</span>
<span class="sd">        New ChannelFrame containing the channel difference</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># label2index is a method of BaseFrame</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other_channel</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;label2index&quot;</span><span class="p">):</span>
            <span class="n">other_channel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label2index</span><span class="p">(</span><span class="n">other_channel</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span><span class="s2">&quot;channel_difference&quot;</span><span class="p">,</span> <span class="n">other_channel</span><span class="o">=</span><span class="n">other_channel</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.resampling" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">resampling</span><span class="p">(</span><span class="n">target_sr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.resampling" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Resample audio data.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>target_sr</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Target sampling rate (Hz)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
                  <code><span title="typing.Any">Any</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional resampling parameters</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resampled ChannelFrame</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">resampling</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">target_sr</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Resample audio data.</span>

<span class="sd">    Args:</span>
<span class="sd">        target_sr: Target sampling rate (Hz)</span>
<span class="sd">        **kwargs: Additional resampling parameters</span>

<span class="sd">    Returns:</span>
<span class="sd">        Resampled ChannelFrame</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">T_Processing</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
            <span class="s2">&quot;resampling&quot;</span><span class="p">,</span>
            <span class="n">target_sr</span><span class="o">=</span><span class="n">target_sr</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_harmonic" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">hpss_harmonic</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_harmonic" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extract harmonic components using HPSS
 (Harmonic-Percussive Source Separation).</p>
<p>This method separates the harmonic (tonal) components from the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kernel_size</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>, <span title="tuple">tuple</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>, <span title="librosa._typing._IntLike_co">_IntLike_co</span>], <span title="list">list</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Median filter size for HPSS.</p>
              </div>
            </td>
            <td>
                  <code>31</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>power</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent for the Weiner filter used in HPSS.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>, <span title="tuple">tuple</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>, <span title="librosa._typing._FloatLike_co">_FloatLike_co</span>], <span title="list">list</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Margin size for the separation.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Size of FFT window.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Hop length for STFT.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length for STFT.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="librosa._typing._WindowSpec">_WindowSpec</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type for STFT.</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>center</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, center the frames.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pad_mode</code>
            </td>
            <td>
                  <code><span title="librosa._typing._PadModeSTFT">_PadModeSTFT</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Padding mode for STFT.</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the harmonic components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hpss_harmonic</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
    <span class="n">power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">margin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span>
        <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
        <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="s2">&quot;_WindowSpec&quot;</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">pad_mode</span><span class="p">:</span> <span class="s2">&quot;_PadModeSTFT&quot;</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract harmonic components using HPSS</span>
<span class="sd">     (Harmonic-Percussive Source Separation).</span>

<span class="sd">    This method separates the harmonic (tonal) components from the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        kernel_size: Median filter size for HPSS.</span>
<span class="sd">        power: Exponent for the Weiner filter used in HPSS.</span>
<span class="sd">        margin: Margin size for the separation.</span>
<span class="sd">        n_fft: Size of FFT window.</span>
<span class="sd">        hop_length: Hop length for STFT.</span>
<span class="sd">        win_length: Window length for STFT.</span>
<span class="sd">        window: Window type for STFT.</span>
<span class="sd">        center: If True, center the frames.</span>
<span class="sd">        pad_mode: Padding mode for STFT.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the harmonic components.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
        <span class="s2">&quot;hpss_harmonic&quot;</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_percussive" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">hpss_percussive</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">31</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_processing_mixin.ChannelProcessingMixin.hpss_percussive" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Extract percussive components using HPSS
(Harmonic-Percussive Source Separation).</p>
<p>This method separates the percussive (tonal) components from the signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kernel_size</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>, <span title="tuple">tuple</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>, <span title="librosa._typing._IntLike_co">_IntLike_co</span>], <span title="list">list</span>[<span title="librosa._typing._IntLike_co">_IntLike_co</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Median filter size for HPSS.</p>
              </div>
            </td>
            <td>
                  <code>31</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>power</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Exponent for the Weiner filter used in HPSS.</p>
              </div>
            </td>
            <td>
                  <code>2</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>margin</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>, <span title="tuple">tuple</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>, <span title="librosa._typing._FloatLike_co">_FloatLike_co</span>], <span title="list">list</span>[<span title="librosa._typing._FloatLike_co">_FloatLike_co</span>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Margin size for the separation.</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            T_Processing = TypeVar('T_Processing', bound=ProcessingFrameProtocol)

  
      module-attribute
   (wandas.frames.mixins.protocols.T_Processing)" href="../../../api/#wandas.frames.mixins.protocols.T_Processing">T_Processing</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A new ChannelFrame containing the harmonic components.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_processing_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">hpss_percussive</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Processing</span><span class="p">,</span>
    <span class="n">kernel_size</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_IntLike_co&quot;</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_IntLike_co&quot;</span><span class="p">]</span>
    <span class="p">]</span> <span class="o">=</span> <span class="mi">31</span><span class="p">,</span>
    <span class="n">power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">margin</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span>
        <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span>
        <span class="nb">tuple</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">,</span> <span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
        <span class="nb">list</span><span class="p">[</span><span class="s2">&quot;_FloatLike_co&quot;</span><span class="p">],</span>
    <span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="s2">&quot;_WindowSpec&quot;</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">center</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">pad_mode</span><span class="p">:</span> <span class="s2">&quot;_PadModeSTFT&quot;</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">T_Processing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract percussive components using HPSS</span>
<span class="sd">    (Harmonic-Percussive Source Separation).</span>

<span class="sd">    This method separates the percussive (tonal) components from the signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        kernel_size: Median filter size for HPSS.</span>
<span class="sd">        power: Exponent for the Weiner filter used in HPSS.</span>
<span class="sd">        margin: Margin size for the separation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A new ChannelFrame containing the harmonic components.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">apply_operation</span><span class="p">(</span>
        <span class="s2">&quot;hpss_percussive&quot;</span><span class="p">,</span>
        <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span>
        <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span>
        <span class="n">margin</span><span class="o">=</span><span class="n">margin</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">center</span><span class="o">=</span><span class="n">center</span><span class="p">,</span>
        <span class="n">pad_mode</span><span class="o">=</span><span class="n">pad_mode</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">T_Processing</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div><h3 id="channeltransformmixin">ChannelTransformMixin<a class="headerlink" href="#channeltransformmixin" title="Permanent link">&para;</a></h3>


<div class="doc doc-object doc-class">



<h2 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin</code>


<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">


        <p>Mixin providing methods related to frequency transformations.</p>
<p>This mixin provides operations related to frequency analysis and
transformations such as FFT, STFT, and Welch method.</p>







              <details class="quote">
                <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ChannelTransformMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin providing methods related to frequency transformations.</span>

<span class="sd">    This mixin provides operations related to frequency analysis and</span>
<span class="sd">    transformations such as FFT, STFT, and Welch method.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">fft</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate Fast Fourier Transform (FFT).</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is the next power of 2 of the data</span>
<span class="sd">                length.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectralFrame containing FFT results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FFT</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;fft&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;FFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># Apply processing to data</span>
        <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">n_fft</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">is_even</span> <span class="o">=</span> <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
            <span class="n">_n_fft</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
                <span class="k">if</span> <span class="n">is_even</span>
                <span class="k">else</span> <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">_n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Spectrum of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span> <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">_n_fft</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;fft&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">_n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">}},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">welch</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate power spectral density using Welch&#39;s method.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">            hop_length: Number of samples between frames.</span>
<span class="sd">                Default is n_fft//4.</span>
<span class="sd">            win_length: Window length. Default is n_fft.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">            average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectralFrame containing power spectral density</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Welch</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span> <span class="ow">or</span> <span class="n">win_length</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
            <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">average</span><span class="o">=</span><span class="n">average</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;welch&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Welch&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># Apply processing to data</span>
        <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Spectrum of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;welch&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">noct_spectrum</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
        <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NOctFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate N-octave band spectrum.</span>

<span class="sd">        Args:</span>
<span class="sd">            fmin: Minimum center frequency (Hz). Default is 20 Hz.</span>
<span class="sd">            fmax: Maximum center frequency (Hz). Default is 20000 Hz.</span>
<span class="sd">            n: Band division (1: octave, 3: 1/3 octave). Default is 3.</span>
<span class="sd">            G: Reference gain (dB). Default is 10 dB.</span>
<span class="sd">            fr: Reference frequency (Hz). Default is 1000 Hz.</span>

<span class="sd">        Returns:</span>
<span class="sd">            NOctFrame containing N-octave band spectrum</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctSpectrum</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">..noct</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctFrame</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fmin&quot;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s2">&quot;fmax&quot;</span><span class="p">:</span> <span class="n">fmax</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span> <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="n">fr</span><span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;noct_spectrum&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;NOctSpectrum&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
        <span class="c1"># Apply processing to data</span>
        <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">NOctFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span>
            <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
            <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
            <span class="n">G</span><span class="o">=</span><span class="n">G</span><span class="p">,</span>
            <span class="n">fr</span><span class="o">=</span><span class="n">fr</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">Oct of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;noct_spectrum&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">stft</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectrogramFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate Short-Time Fourier Transform.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">            hop_length: Number of samples between frames.</span>
<span class="sd">                Default is n_fft//4.</span>
<span class="sd">            win_length: Window length. Default is n_fft.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectrogramFrame containing STFT results</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">STFT</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">..spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramFrame</span>

        <span class="c1"># Set hop length and window length</span>
        <span class="n">_hop_length</span> <span class="o">=</span> <span class="n">hop_length</span> <span class="k">if</span> <span class="n">hop_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span> <span class="o">//</span> <span class="mi">4</span>
        <span class="n">_win_length</span> <span class="o">=</span> <span class="n">win_length</span> <span class="k">if</span> <span class="n">win_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">_hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">_win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;stft&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;STFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">spectrogram_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectrogramFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>  <span class="c1"># noqa: E501</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Create new instance</span>
        <span class="k">return</span> <span class="n">SpectrogramFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">spectrogram_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">hop_length</span><span class="o">=</span><span class="n">_hop_length</span><span class="p">,</span>
            <span class="n">win_length</span><span class="o">=</span><span class="n">_win_length</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;stft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">coherence</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate magnitude squared coherence.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">            hop_length: Number of samples between frames.</span>
<span class="sd">                Default is n_fft//4.</span>
<span class="sd">            win_length: Window length. Default is n_fft.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">            detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectralFrame containing magnitude squared coherence</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coherence</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">..spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;coherence&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">coherence_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Create new channel metadata</span>
        <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">gamma_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

        <span class="c1"># Create new instance</span>
        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">coherence_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Coherence of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">csd</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
        <span class="n">scaling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">,</span>
        <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate cross-spectral density matrix.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">            hop_length: Number of samples between frames.</span>
<span class="sd">                Default is n_fft//4.</span>
<span class="sd">            win_length: Window length. Default is n_fft.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">            detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>
<span class="sd">            scaling: Scaling method. Options: &quot;spectrum&quot;, &quot;density&quot;.</span>
<span class="sd">            average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectralFrame containing cross-spectral density matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSD</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
            <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="n">scaling</span><span class="p">,</span>
            <span class="s2">&quot;average&quot;</span><span class="p">:</span> <span class="n">average</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;csd&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;CSD&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">csd_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Create new channel metadata</span>
        <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

        <span class="c1"># Create new instance</span>
        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">csd_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$C_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">transfer_function</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
        <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
        <span class="n">scaling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">,</span>
        <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate transfer function matrix.</span>

<span class="sd">        The transfer function represents the signal transfer characteristics between</span>
<span class="sd">        channels in the frequency domain and represents the input-output relationship</span>
<span class="sd">        of the system.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">            hop_length: Number of samples between frames.</span>
<span class="sd">                Default is n_fft//4.</span>
<span class="sd">            win_length: Window length. Default is n_fft.</span>
<span class="sd">            window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">            detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>
<span class="sd">            scaling: Scaling method. Options: &quot;spectrum&quot;, &quot;density&quot;.</span>
<span class="sd">            average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            SpectralFrame containing transfer function matrix</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransferFunction</span><span class="p">,</span> <span class="n">create_operation</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
            <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
            <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
            <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
            <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
            <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="n">scaling</span><span class="p">,</span>
            <span class="s2">&quot;average&quot;</span><span class="p">:</span> <span class="n">average</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;transfer_function&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

        <span class="c1"># Create operation instance</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
        <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;TransferFunction&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

        <span class="c1"># Apply processing to data</span>
        <span class="n">tf_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
        <span class="p">)</span>

        <span class="c1"># Cast self as BaseFrame type</span>
        <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># Create new channel metadata</span>
        <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
                <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$H_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                    <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

        <span class="c1"># Create new instance</span>
        <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">tf_data</span><span class="p">,</span>
            <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
            <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
            <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Transfer function of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
            <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
                <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
                <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
            <span class="p">],</span>
            <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
            <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<h3 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin-functions">Functions<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.fft" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">fft</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.fft" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate Fast Fourier Transform (FFT).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is the next power of 2 of the data
length.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectralFrame (wandas.frames.spectral.SpectralFrame)" href="../../../api/#wandas.frames.spectral.SpectralFrame">SpectralFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectralFrame containing FFT results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fft</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span> <span class="n">n_fft</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate Fast Fourier Transform (FFT).</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is the next power of 2 of the data</span>
<span class="sd">            length.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectralFrame containing FFT results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">FFT</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;fft&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;FFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># Apply processing to data</span>
    <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">n_fft</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">is_even</span> <span class="o">=</span> <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">_n_fft</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">is_even</span>
            <span class="k">else</span> <span class="n">spectrum_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_n_fft</span> <span class="o">=</span> <span class="n">n_fft</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">_n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Spectrum of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span> <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">_n_fft</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;fft&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">_n_fft</span><span class="p">,</span> <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">}},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.welch" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">welch</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.welch" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate power spectral density using Welch's method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples between frames.
Default is n_fft//4.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length. Default is n_fft.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>average</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for averaging segments. Default is "mean".</p>
              </div>
            </td>
            <td>
                  <code>&#39;mean&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectralFrame (wandas.frames.spectral.SpectralFrame)" href="../../../api/#wandas.frames.spectral.SpectralFrame">SpectralFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectralFrame containing power spectral density</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">welch</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate power spectral density using Welch&#39;s method.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">        hop_length: Number of samples between frames.</span>
<span class="sd">            Default is n_fft//4.</span>
<span class="sd">        win_length: Window length. Default is n_fft.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">        average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectralFrame containing power spectral density</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Welch</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span> <span class="ow">or</span> <span class="n">win_length</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">hop_length</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">win_length</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">average</span><span class="o">=</span><span class="n">average</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;welch&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Welch&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># Apply processing to data</span>
    <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Spectrum of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;welch&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.noct_spectrum" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">noct_spectrum</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">G</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">fr</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.noct_spectrum" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate N-octave band spectrum.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>fmin</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimum center frequency (Hz). Default is 20 Hz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fmax</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum center frequency (Hz). Default is 20000 Hz.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Band division (1: octave, 3: 1/3 octave). Default is 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>G</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference gain (dB). Default is 10 dB.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fr</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Reference frequency (Hz). Default is 1000 Hz.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            NOctFrame (wandas.frames.noct.NOctFrame)" href="../../../api/#wandas.frames.noct.NOctFrame">NOctFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>NOctFrame containing N-octave band spectrum</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">noct_spectrum</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">fmin</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">fmax</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">G</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>  <span class="c1"># noqa: N803</span>
    <span class="n">fr</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;NOctFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate N-octave band spectrum.</span>

<span class="sd">    Args:</span>
<span class="sd">        fmin: Minimum center frequency (Hz). Default is 20 Hz.</span>
<span class="sd">        fmax: Maximum center frequency (Hz). Default is 20000 Hz.</span>
<span class="sd">        n: Band division (1: octave, 3: 1/3 octave). Default is 3.</span>
<span class="sd">        G: Reference gain (dB). Default is 10 dB.</span>
<span class="sd">        fr: Reference frequency (Hz). Default is 1000 Hz.</span>

<span class="sd">    Returns:</span>
<span class="sd">        NOctFrame containing N-octave band spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctSpectrum</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">..noct</span><span class="w"> </span><span class="kn">import</span> <span class="n">NOctFrame</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;fmin&quot;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s2">&quot;fmax&quot;</span><span class="p">:</span> <span class="n">fmax</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span> <span class="n">n</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">:</span> <span class="n">G</span><span class="p">,</span> <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="n">fr</span><span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;noct_spectrum&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;NOctSpectrum&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>
    <span class="c1"># Apply processing to data</span>
    <span class="n">spectrum_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">NOctFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">spectrum_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span>
        <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span>
        <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">,</span>
        <span class="n">G</span><span class="o">=</span><span class="n">G</span><span class="p">,</span>
        <span class="n">fr</span><span class="o">=</span><span class="n">fr</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;1/</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">Oct of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="s2">&quot;noct_spectrum&quot;</span><span class="p">,</span>
                <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
            <span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.stft" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">stft</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.stft" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate Short-Time Fourier Transform.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples between frames.
Default is n_fft//4.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length. Default is n_fft.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectrogramFrame (wandas.frames.spectrogram.SpectrogramFrame)" href="../../../api/#wandas.frames.spectrogram.SpectrogramFrame">SpectrogramFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectrogramFrame containing STFT results</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stft</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectrogramFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate Short-Time Fourier Transform.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">        hop_length: Number of samples between frames.</span>
<span class="sd">            Default is n_fft//4.</span>
<span class="sd">        win_length: Window length. Default is n_fft.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectrogramFrame containing STFT results</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">STFT</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">..spectrogram</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectrogramFrame</span>

    <span class="c1"># Set hop length and window length</span>
    <span class="n">_hop_length</span> <span class="o">=</span> <span class="n">hop_length</span> <span class="k">if</span> <span class="n">hop_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span> <span class="o">//</span> <span class="mi">4</span>
    <span class="n">_win_length</span> <span class="o">=</span> <span class="n">win_length</span> <span class="k">if</span> <span class="n">win_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">n_fft</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
        <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">_hop_length</span><span class="p">,</span>
        <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">_win_length</span><span class="p">,</span>
        <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;stft&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;STFT&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

    <span class="c1"># Apply processing to data</span>
    <span class="n">spectrogram_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectrogramFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>  <span class="c1"># noqa: E501</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Create new instance</span>
    <span class="k">return</span> <span class="n">SpectrogramFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">spectrogram_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">hop_length</span><span class="o">=</span><span class="n">_hop_length</span><span class="p">,</span>
        <span class="n">win_length</span><span class="o">=</span><span class="n">_win_length</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;stft(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.coherence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">coherence</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.coherence" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate magnitude squared coherence.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples between frames.
Default is n_fft//4.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length. Default is n_fft.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detrend</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detrend method. Options: "constant", "linear", None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectralFrame (wandas.frames.spectral.SpectralFrame)" href="../../../api/#wandas.frames.spectral.SpectralFrame">SpectralFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectralFrame containing magnitude squared coherence</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">coherence</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate magnitude squared coherence.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">        hop_length: Number of samples between frames.</span>
<span class="sd">            Default is n_fft//4.</span>
<span class="sd">        win_length: Window length. Default is n_fft.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">        detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectralFrame containing magnitude squared coherence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Coherence</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">..spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
        <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
        <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
        <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
        <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;coherence&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;Coherence&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

    <span class="c1"># Apply processing to data</span>
    <span class="n">coherence_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Create new channel metadata</span>
    <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">gamma_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

    <span class="c1"># Create new instance</span>
    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">coherence_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Coherence of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.csd" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">csd</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.csd" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate cross-spectral density matrix.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples between frames.
Default is n_fft//4.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length. Default is n_fft.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detrend</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detrend method. Options: "constant", "linear", None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scaling</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scaling method. Options: "spectrum", "density".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spectrum&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>average</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for averaging segments. Default is "mean".</p>
              </div>
            </td>
            <td>
                  <code>&#39;mean&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectralFrame (wandas.frames.spectral.SpectralFrame)" href="../../../api/#wandas.frames.spectral.SpectralFrame">SpectralFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectralFrame containing cross-spectral density matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">csd</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">,</span>
    <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate cross-spectral density matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">        hop_length: Number of samples between frames.</span>
<span class="sd">            Default is n_fft//4.</span>
<span class="sd">        win_length: Window length. Default is n_fft.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">        detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>
<span class="sd">        scaling: Scaling method. Options: &quot;spectrum&quot;, &quot;density&quot;.</span>
<span class="sd">        average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectralFrame containing cross-spectral density matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">CSD</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
        <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
        <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
        <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
        <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
        <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="n">scaling</span><span class="p">,</span>
        <span class="s2">&quot;average&quot;</span><span class="p">:</span> <span class="n">average</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;csd&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;CSD&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

    <span class="c1"># Apply processing to data</span>
    <span class="n">csd_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Create new channel metadata</span>
    <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

    <span class="c1"># Create new instance</span>
    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">csd_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;$C_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.transfer_function" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">transfer_function</span><span class="p">(</span><span class="n">n_fft</span><span class="o">=</span><span class="mi">2048</span><span class="p">,</span> <span class="n">hop_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">win_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s1">&#39;hann&#39;</span><span class="p">,</span> <span class="n">detrend</span><span class="o">=</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="n">scaling</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="n">average</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">)</span></code>

<a href="#wandas.frames.mixins.channel_transform_mixin.ChannelTransformMixin.transfer_function" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Calculate transfer function matrix.</p>
<p>The transfer function represents the signal transfer characteristics between
channels in the frequency domain and represents the input-output relationship
of the system.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_fft</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of FFT points. Default is 2048.</p>
              </div>
            </td>
            <td>
                  <code>2048</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hop_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples between frames.
Default is n_fft//4.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>win_length</code>
            </td>
            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="int">int</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window length. Default is n_fft.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>window</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Window type. Default is "hann".</p>
              </div>
            </td>
            <td>
                  <code>&#39;hann&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>detrend</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Detrend method. Options: "constant", "linear", None.</p>
              </div>
            </td>
            <td>
                  <code>&#39;constant&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scaling</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Scaling method. Options: "spectrum", "density".</p>
              </div>
            </td>
            <td>
                  <code>&#39;spectrum&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>average</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Method for averaging segments. Default is "mean".</p>
              </div>
            </td>
            <td>
                  <code>&#39;mean&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="            SpectralFrame (wandas.frames.spectral.SpectralFrame)" href="../../../api/#wandas.frames.spectral.SpectralFrame">SpectralFrame</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>SpectralFrame containing transfer function matrix</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>wandas/frames/mixins/channel_transform_mixin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">transfer_function</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">:</span> <span class="n">T_Transform</span><span class="p">,</span>
    <span class="n">n_fft</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2048</span><span class="p">,</span>
    <span class="n">hop_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">win_length</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">window</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;hann&quot;</span><span class="p">,</span>
    <span class="n">detrend</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;constant&quot;</span><span class="p">,</span>
    <span class="n">scaling</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;spectrum&quot;</span><span class="p">,</span>
    <span class="n">average</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mean&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;SpectralFrame&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate transfer function matrix.</span>

<span class="sd">    The transfer function represents the signal transfer characteristics between</span>
<span class="sd">    channels in the frequency domain and represents the input-output relationship</span>
<span class="sd">    of the system.</span>

<span class="sd">    Args:</span>
<span class="sd">        n_fft: Number of FFT points. Default is 2048.</span>
<span class="sd">        hop_length: Number of samples between frames.</span>
<span class="sd">            Default is n_fft//4.</span>
<span class="sd">        win_length: Window length. Default is n_fft.</span>
<span class="sd">        window: Window type. Default is &quot;hann&quot;.</span>
<span class="sd">        detrend: Detrend method. Options: &quot;constant&quot;, &quot;linear&quot;, None.</span>
<span class="sd">        scaling: Scaling method. Options: &quot;spectrum&quot;, &quot;density&quot;.</span>
<span class="sd">        average: Method for averaging segments. Default is &quot;mean&quot;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        SpectralFrame containing transfer function matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.core.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">ChannelMetadata</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.frames.spectral</span><span class="w"> </span><span class="kn">import</span> <span class="n">SpectralFrame</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">wandas.processing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TransferFunction</span><span class="p">,</span> <span class="n">create_operation</span>

    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;n_fft&quot;</span><span class="p">:</span> <span class="n">n_fft</span><span class="p">,</span>
        <span class="s2">&quot;hop_length&quot;</span><span class="p">:</span> <span class="n">hop_length</span><span class="p">,</span>
        <span class="s2">&quot;win_length&quot;</span><span class="p">:</span> <span class="n">win_length</span><span class="p">,</span>
        <span class="s2">&quot;window&quot;</span><span class="p">:</span> <span class="n">window</span><span class="p">,</span>
        <span class="s2">&quot;detrend&quot;</span><span class="p">:</span> <span class="n">detrend</span><span class="p">,</span>
        <span class="s2">&quot;scaling&quot;</span><span class="p">:</span> <span class="n">scaling</span><span class="p">,</span>
        <span class="s2">&quot;average&quot;</span><span class="p">:</span> <span class="n">average</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">operation_name</span> <span class="o">=</span> <span class="s2">&quot;transfer_function&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Applying operation=</span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> with params=</span><span class="si">{</span><span class="n">params</span><span class="si">}</span><span class="s2"> (lazy)&quot;</span><span class="p">)</span>

    <span class="c1"># Create operation instance</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">create_operation</span><span class="p">(</span><span class="n">operation_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="n">operation</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s2">&quot;TransferFunction&quot;</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span>

    <span class="c1"># Apply processing to data</span>
    <span class="n">tf_data</span> <span class="o">=</span> <span class="n">operation</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Created new SpectralFrame with operation </span><span class="si">{</span><span class="n">operation_name</span><span class="si">}</span><span class="s2"> added to graph&quot;</span>
    <span class="p">)</span>

    <span class="c1"># Cast self as BaseFrame type</span>
    <span class="n">base_self</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">BaseFrame</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span> <span class="bp">self</span><span class="p">)</span>

    <span class="c1"># Create new channel metadata</span>
    <span class="n">channel_metadata</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">in_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">out_ch</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_channel_metadata</span><span class="p">:</span>
            <span class="n">meta</span> <span class="o">=</span> <span class="n">ChannelMetadata</span><span class="p">()</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$H_</span><span class="se">{{</span><span class="si">{</span><span class="n">in_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">out_ch</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="se">}}</span><span class="s2">$&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">meta</span><span class="o">.</span><span class="n">ref</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">meta</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">in_ch</span><span class="o">=</span><span class="n">in_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">],</span> <span class="n">out_ch</span><span class="o">=</span><span class="n">out_ch</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="n">channel_metadata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">meta</span><span class="p">)</span>

    <span class="c1"># Create new instance</span>
    <span class="k">return</span> <span class="n">SpectralFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">tf_data</span><span class="p">,</span>
        <span class="n">sampling_rate</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
        <span class="n">n_fft</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">n_fft</span><span class="p">,</span>
        <span class="n">window</span><span class="o">=</span><span class="n">operation</span><span class="o">.</span><span class="n">window</span><span class="p">,</span>
        <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Transfer function of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
        <span class="n">metadata</span><span class="o">=</span><span class="p">{</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">},</span>
        <span class="n">operation_history</span><span class="o">=</span><span class="p">[</span>
            <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">operation_history</span><span class="p">,</span>
            <span class="p">{</span><span class="s2">&quot;operation&quot;</span><span class="p">:</span> <span class="n">operation_name</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span>
        <span class="p">],</span>
        <span class="n">channel_metadata</span><span class="o">=</span><span class="n">channel_metadata</span><span class="p">,</span>
        <span class="n">previous</span><span class="o">=</span><span class="n">base_self</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="May 11, 2025 13:46:30">May 11, 2025</span>
  </span>

    
    
    
    
  </aside>


  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2025 Wandas Team
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/kasahart/wandas" target="_blank" rel="noopener" title="Wandas on GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.tracking", "navigation.top", "search.highlight", "search.share"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../../assets/_markdown_exec_pyodide.js"></script>
      
        <script src="../../../assets/_markdown_exec_pyodide.js"></script>
      
    
  </body>
</html>